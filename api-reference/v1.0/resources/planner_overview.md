# <a name="use-the-planner-rest-api"></a><span data-ttu-id="4b3d7-101">使用 Planner REST API</span><span class="sxs-lookup"><span data-stu-id="4b3d7-101">Use the Planner API</span></span>

<span data-ttu-id="4b3d7-102">可以使用在 Microsoft Graph 中使用 Planner API 创建任务并将其分配给 Office 365 中的某个组中的用户。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-102">You can use the Planner API in Microsoft Graph to create tasks and assign them to users in a group in Office 365.</span></span>

<span data-ttu-id="4b3d7-103">开始使用 Planner API 之前，需要了解主对象互相之间以及与 Office 365 组的关系。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-103">Before you get started with trying out the Planner API, it is worth understanding how the main objects in Planner API relate to each other as well as Office 365 groups.</span></span>

## <a name="groups"></a><span data-ttu-id="4b3d7-104">组</span><span class="sxs-lookup"><span data-stu-id="4b3d7-104">Groups</span></span>

<span data-ttu-id="4b3d7-105">Office 365 组是 Planner API 中计划的所有者。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-105">Office 365 groups are the owners of the plans in the Planner API. To get the plans owned by a group, make the HTTP request below.</span></span>
<span data-ttu-id="4b3d7-106">为 [获取由一个组所拥有的计划](../api/plannergroup_list_plans.md)，请进行以下 HTTP 请求。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-106">To [get the plans owned by a group](../api/plannergroup_list_plans.md), make the following HTTP request.</span></span>

``` http
GET /groups/{id}/planner/plans
```

<span data-ttu-id="4b3d7-107">当[创建新的计划](../api/planner_post_plans.md)，通过设置计划对象的 `owner` 属性可以使组成为其所有者。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-107">When [creating a new plan](../api/planner_post_plans.md), make a group its owner by simply setting the `owner` property on a plan object. Plans must be owned by groups.</span></span> <span data-ttu-id="4b3d7-108">计划必须由组作为其所有者。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-108">Plans must be owned by groups.</span></span>

><span data-ttu-id="4b3d7-109">**注意：** 创建计划的用户必须是将拥有计划的组的成员。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-109">**Note:** The user who is creating the plan must be a member of the group that will own the plan.</span></span> <span data-ttu-id="4b3d7-110">当使用[新建组](../api/group_post_groups.md)创建新组时，你不会作为成员添加到该组。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-110">When you create a new group by using [Create group](../api/group_post_groups.md), you are not added to the group as a member.</span></span> <span data-ttu-id="4b3d7-111">创建组后，需使用[组发布成员](../api/group_post_members.md)将自己添加为成员。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-111">After the group is created, add yourself as a member by using [group post members](../api/group_post_members.md).</span></span>

## <a name="plans"></a><span data-ttu-id="4b3d7-112">计划</span><span class="sxs-lookup"><span data-stu-id="4b3d7-112">Plans</span></span>

<span data-ttu-id="4b3d7-113">[计划](plannerplan.md)是[任务](plannertask.md)的容器。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-113">[Plans](plannerplan.md) are the containers of [tasks](plannertask.md).</span></span> <span data-ttu-id="4b3d7-114">要[在计划中创建任务](../api/planner_post_tasks.md)，请在创建任务时将任务对象的 `planId` 属性设置为计划的 ID。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-114">Plans are the containers of tasks. To [create a task in a plan](../api/planner_post_tasks.md), set the `planId` property on the task object to the ID of the plan while creating the task. Tasks currently cannot be created without plans. To retrieve the tasks in a plan, make the HTTP request below.</span></span>
<span data-ttu-id="4b3d7-115">当前无法在没有计划的情况下创建任务。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-115">Tasks currently cannot be created without plans.</span></span>
<span data-ttu-id="4b3d7-116">要[检索计划中的任务](../api/plannerplan_list_tasks.md)，请进行以下 HTTP 请求。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-116">To [retrieve the tasks in a plan](../api/plannerplan_list_tasks.md), make the following HTTP request.</span></span>

``` http
GET /planner/plans/{id}/tasks
```

## <a name="tasks"></a><span data-ttu-id="4b3d7-117">任务</span><span class="sxs-lookup"><span data-stu-id="4b3d7-117">Tasks</span></span>

<span data-ttu-id="4b3d7-p105">可以通过在任务对象的 [assignments](plannerassignments.md) 属性中添加[分配](plannerassignment.md)将每个任务分配给一位用户。要分配任务的用户 ID 是 `assignments` 上的开放属性的名称，且必须指定分配上的 `orderHint` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p105">Each task can be assigned to a user by adding an [assignment](plannerassignment.md) in the [assignments](plannerassignments.md) property on the task object. The ID of the user to assign the task is the name of the open property on `assignments`, and the `orderHint` property on the assignment must be specified.</span></span>

## <a name="task-and-plan-details"></a><span data-ttu-id="4b3d7-120">任务和计划详细信息</span><span class="sxs-lookup"><span data-stu-id="4b3d7-120">Task and plan details</span></span> 

<span data-ttu-id="4b3d7-p106">Planner 资源会排列到基本对象和详细对象中。基本对象提供对适合列表视图的资源的通用属性的访问权限，而详细对象提供对适合深化视图的资源的大型属性的访问权限。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p106">Planner resources are arranged into basic objects and detail objects. Basic objects provide access to common properties of the resources, suitable for list views, while the detail objects provide access to large properties of the resources suitable for drill down views.</span></span>

## <a name="visualization"></a><span data-ttu-id="4b3d7-123">可视化</span><span class="sxs-lookup"><span data-stu-id="4b3d7-123">Visualization</span></span>

<span data-ttu-id="4b3d7-p107">除任务和计划数据外，Planner API 还能提供资源，以便跨客户端提供数据的常见可视化。有几种类型的可视化数据可用于任务：</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p107">Aside from task and plan data, the Planner API also provides resources to provide common visualization of data across clients. Several types of visualization data are available for tasks:</span></span>

| <span data-ttu-id="4b3d7-126">任务如下所示</span><span class="sxs-lookup"><span data-stu-id="4b3d7-126">Tasks are shown as</span></span>                                                                        | <span data-ttu-id="4b3d7-127">使用以下信息对任务进行排序</span><span class="sxs-lookup"><span data-stu-id="4b3d7-127">Tasks are ordered with information from</span></span>                                         |
| :---------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------ |
| <span data-ttu-id="4b3d7-128">简单列表（计划中的任务）</span><span class="sxs-lookup"><span data-stu-id="4b3d7-128">Flat list (tasks in a plan)</span></span>                                                               | <span data-ttu-id="4b3d7-129">`orderHint` 任务的属性</span><span class="sxs-lookup"><span data-stu-id="4b3d7-129">`orderHint` property on tasks</span></span>                                                   |
| <span data-ttu-id="4b3d7-130">简单列表（分配给用户的任务）</span><span class="sxs-lookup"><span data-stu-id="4b3d7-130">Flat list (tasks assigned to a user)</span></span>                                                      | <span data-ttu-id="4b3d7-131">`assigneePriority` 任务的属性</span><span class="sxs-lookup"><span data-stu-id="4b3d7-131">`assigneePriority` property on tasks</span></span>                                            |
| <span data-ttu-id="4b3d7-132">包含受理人列的板块视图（分配给任务板块）</span><span class="sxs-lookup"><span data-stu-id="4b3d7-132">Board view with columns for assignees (assigned to task board)</span></span>                            | <span data-ttu-id="4b3d7-133">[assignedToTaskBoardTaskFormat](plannerassignedToTaskBoardTaskFormat.md) 对象</span><span class="sxs-lookup"><span data-stu-id="4b3d7-133">[assignedToTaskBoardTaskFormat](plannerassignedToTaskBoardTaskFormat.md) object</span></span> |
| <span data-ttu-id="4b3d7-134">包含针对完成情况的任务进度列的板块视图（进度任务板块）</span><span class="sxs-lookup"><span data-stu-id="4b3d7-134">Board view with columns for progress of the task towards completion (progress task board)</span></span> | <span data-ttu-id="4b3d7-135">[progressTaskBoardTaskFormat](plannerprogressTaskBoardTaskFormat.md) 对象</span><span class="sxs-lookup"><span data-stu-id="4b3d7-135">[progressTaskBoardTaskFormat](plannerprogressTaskBoardTaskFormat.md) object</span></span>     |
| <span data-ttu-id="4b3d7-136">包含任务自定义列的板块视图（存储桶任务板块）：</span><span class="sxs-lookup"><span data-stu-id="4b3d7-136">Board view with custom columns of tasks (bucket task board):</span></span>                              | <span data-ttu-id="4b3d7-137">[bucketTaskBoardTaskFormat](plannerbucketTaskBoardTaskFormat.md) 对象</span><span class="sxs-lookup"><span data-stu-id="4b3d7-137">[bucketTaskBoardTaskFormat](plannerbucketTaskBoardTaskFormat.md) object</span></span>         |

<span data-ttu-id="4b3d7-138">存储桶任务板块中的自定义栏由 [bucket](plannerbucket.md) 对象表示，其顺序由对象的 `orderHint` 属性表示。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-138">The custom columns in the bucket task board are represented by [bucket](plannerbucket.md) objects, and their order by `orderHint` property on the object.</span></span>

<span data-ttu-id="4b3d7-139">所有排序均由 [Planner 顺序提示](planner_order_hint_format.md)中的原则指定。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-139">All the ordering is controlled by the principles identified in [Planner order hints](planner_order_hint_format.md).</span></span>

## <a name="planner-resource-versioning"></a><span data-ttu-id="4b3d7-140">Planner 资源版本控制</span><span class="sxs-lookup"><span data-stu-id="4b3d7-140">Planner resource versioning</span></span>

<span data-ttu-id="4b3d7-p108">Planner 使用 etag 对所有资源进行版本控制。这些 etags 与每个资源的 `@odata.etag` 属性一起返回，且 `PATCH` 和 `DELETE` 请求需要使用 `If-Match` 标头指定客户端已知的最后一个 etag。如果目标更改与相同资源上的 Planner 服务接受的较新更改不冲突，则 Planner 允许对资源的旧版本进行更改。客户端可以通过计算顺序字符串比较中的较大 etag 值，确定在相同的资源中，哪个 etag 较新。每个资源都有单独的 etag。不同资源的 etag 值（包括具有包含关系的 etag 值）无法比较。按预期，客户端应用需要通过读取项的最新版本处理与错误状态代码 409 和 412 相关的两个版本控制，并解决冲突的更改。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p108">Planner versions all resources using etags. These etags are returned with `@odata.etag` property on each resource, and `PATCH` and `DELETE` requests require the last etag known by the client to be specified with `If-Match` header. Planner allows changes to older versions of resources, if the intended change does not conflict with newer changes accepted by the Planner service on the same resource. The clients can identify which etag for the same resource is newer by calculating which etag value is greater in ordinal string comparison. Each resource has a separate etag. Etag values for different resources, including those with containment relationships, cannot be compared. The client apps are expected to handle two versioning related error status codes 409 and 412 by reading the latest version of the item, and resolving the conflicting changes.</span></span>

## <a name="common-planner-error-conditions"></a><span data-ttu-id="4b3d7-148">常见的 Planner 错误条件</span><span class="sxs-lookup"><span data-stu-id="4b3d7-148">Common Planner error conditions</span></span>

<span data-ttu-id="4b3d7-149">除了适用于 Microsoft Graph 的[常规错误](../../../concepts/errors.md)外，某些错误条件特定于 Planner API。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-149">In addition to [general errors](../../../concepts/errors.md) that apply to Microsoft Graph, some error conditions are specific to the Planner API.</span></span>

### <a name="400-bad-request"></a><span data-ttu-id="4b3d7-150">400 错误的请求</span><span class="sxs-lookup"><span data-stu-id="4b3d7-150">400 Bad request</span></span>

<span data-ttu-id="4b3d7-p109">在几种常见情况下，`POST` 和 `PATCH` 请求可能收到 400 状态代码。常见问题包括：</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p109">There are several common cases where the `POST` and `PATCH` requests can get a 400 status code. Common problems include:</span></span>

* <span data-ttu-id="4b3d7-p110">开放类型属性的类型不正确，或该类型未指定，或它们不包含任何属性。例如，包含复杂值的 [plannerAssignments](plannerAssignments.md) 属性需要声明包含 `microsoft.graph.plannerAssignment` 值的 `@odata.type` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p110">Open Type properties are not of correct types, or the type isn't specified, or they do not contain any properties. For example, [plannerAssignments](plannerAssignments.md) properties with complex values need to declare `@odata.type` property with value `microsoft.graph.plannerAssignment`.</span></span>
* <span data-ttu-id="4b3d7-p111">顺序提示值不具有[正确格式](planner_order_hint_format.md)。例如，顺序提示值被直接设置为返回到客户端的值。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p111">Order hint values do not have the [correct format](planner_order_hint_format.md). For example, an order hint value is being set directly to the value returned to the client.</span></span>
* <span data-ttu-id="4b3d7-p112">数据在逻辑上不一致。例如，任务的开始日期晚于任务的到期日期。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p112">The data is logically inconsistent. For example, start date of task is later than due date of the task.</span></span>

### <a name="403-forbidden"></a><span data-ttu-id="4b3d7-159">403 已禁止</span><span class="sxs-lookup"><span data-stu-id="4b3d7-159">403 Forbidden</span></span>

<span data-ttu-id="4b3d7-p113">除常规错误外，当超出服务定义的限制时，Planner API 还会返回此状态代码。如果出现这种情况，错误资源类型上的 `code` 属性将标识请求超出的限制类型。限制类型的可能值包括：</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p113">In addition to the general errors, the Planner API also returns this status code when a service-defined limit has been exceeded. If this is the case, the `code` property on the error resource type will indicate the type of the limit exceeded by the request. The possible values for the limit types include:</span></span>

| <span data-ttu-id="4b3d7-163">值</span><span class="sxs-lookup"><span data-stu-id="4b3d7-163">Value</span></span>                         | <span data-ttu-id="4b3d7-164">说明</span><span class="sxs-lookup"><span data-stu-id="4b3d7-164">Description</span></span>                                                                                                                                                                                              |
| :---------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="4b3d7-165">MaximumProjectsOwnedByUser</span><span class="sxs-lookup"><span data-stu-id="4b3d7-165">MaximumProjectsOwnedByUser</span></span>    | <span data-ttu-id="4b3d7-p114">已超出组所有的最大 Plan 数限制。此限制基于 [plannerPlan](plannerPlan.md) 资源上的 `owner` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p114">The maximum number of Plans owned by a group limit has been exceeded. This limit is based on the `owner` property on the [plannerPlan](plannerPlan.md) resource.</span></span>                                         |
| <span data-ttu-id="4b3d7-168">MaximumProjectsSharedWithUser</span><span class="sxs-lookup"><span data-stu-id="4b3d7-168">MaximumProjectsSharedWithUser</span></span> | <span data-ttu-id="4b3d7-p115">已超出与用户共享的最大 Plan 数限制。此限制基于 [plannerPlanDetails](plannerPlanDetails.md) 资源上的 `sharedWith` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p115">The maximum number of Plans shared with a user limit has been exceeded.  This limit is based on the `sharedWith` property on the [plannerPlanDetails](plannerPlanDetails.md) resource.</span></span>                   |
| <span data-ttu-id="4b3d7-171">MaximumTasksCreatedByUser</span><span class="sxs-lookup"><span data-stu-id="4b3d7-171">MaximumTasksCreatedByUser</span></span>     | <span data-ttu-id="4b3d7-p116">已超出用户创建的最大 Task 数限制。此限制基于 [plannerTask](plannerTask.md) 资源上的 `createdBy` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p116">The maximum number of Tasks created by a user limit has been exceeded. This limit is based on the `createdBy` property on the [plannerTask](plannerTask.md) resource.</span></span>                                    |
| <span data-ttu-id="4b3d7-174">MaximumTasksAssignedToUser</span><span class="sxs-lookup"><span data-stu-id="4b3d7-174">MaximumTasksAssignedToUser</span></span>    | <span data-ttu-id="4b3d7-p117">已超出分配给用户的最大 Task 数限制。此限制基于 [plannerTask](plannerTask.md) 资源上的 `assignments` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p117">The maximum number of Tasks assigned to a user limit has been exceeded. This limit is based on the `assignments` property on the [plannerTask](plannerTask.md) resource.</span></span>                                 |
| <span data-ttu-id="4b3d7-177">MaximumTasksInProject</span><span class="sxs-lookup"><span data-stu-id="4b3d7-177">MaximumTasksInProject</span></span>         | <span data-ttu-id="4b3d7-p118">已超出 Plan 中的最大 Task 数限制。此限制基于 [plannerTask](plannerTask.md) 资源上的 `planId` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p118">The maximum number of Tasks in a Plan limit has been exceeded. This limit is based on the `planId` property on the [plannerTask](plannerTask.md) resource.</span></span>                                               |
| <span data-ttu-id="4b3d7-180">MaximumActiveTasksInProject</span><span class="sxs-lookup"><span data-stu-id="4b3d7-180">MaximumActiveTasksInProject</span></span>   | <span data-ttu-id="4b3d7-p119">已超出 Plan 中未完成的最大 Task 数限制。此限制基于 [plannerTask](plannerTask.md) 资源上的 `planId` 和 `percentComplete` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p119">The maximum number of Tasks that aren't completed in a Plan limit has been exceeded. This limit is based on the `planId` and `percentComplete` properties on the [plannerTask](plannerTask.md) resource.</span></span> |
| <span data-ttu-id="4b3d7-183">MaximumBucketsInProject</span><span class="sxs-lookup"><span data-stu-id="4b3d7-183">MaximumBucketsInProject</span></span>       | <span data-ttu-id="4b3d7-p120">已超出 Plan 中的最大 Bucket 数限制。此限制基于 [plannerBucket](plannerBucket.md) 资源上的 `planId` 属性。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p120">The maximum number of Buckets in a Plan limit has been exceeded. This limit is based on the `planId` property on the [plannerBucket](plannerBucket.md) resource.</span></span>                                         |
| <span data-ttu-id="4b3d7-186">MaximumUsersSharedWithProject</span><span class="sxs-lookup"><span data-stu-id="4b3d7-186">MaximumUsersSharedWithProject</span></span> | <span data-ttu-id="4b3d7-187">[plannerPlanDetails](plannerPlanDetails.md) 资源上的 `sharedWith` 属性包含的值过多。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-187">The `sharedWith` property on the [plannerPlanDetails](plannerPlanDetails.md) resource contains too many values.</span></span>                                                                                          |
| <span data-ttu-id="4b3d7-188">MaximumReferencesOnTask</span><span class="sxs-lookup"><span data-stu-id="4b3d7-188">MaximumReferencesOnTask</span></span>       | <span data-ttu-id="4b3d7-189">[plannerTaskDetails](plannerTaskDetails.md) 资源上的 `references` 属性包含的值过多。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-189">The `references` property on the [plannerTaskDetails](plannerTaskDetails.md) resource contains too many values.</span></span>                                                                                          |
| <span data-ttu-id="4b3d7-190">MaximumChecklistItemsOnTask</span><span class="sxs-lookup"><span data-stu-id="4b3d7-190">MaximumChecklistItemsOnTask</span></span>   | <span data-ttu-id="4b3d7-191">[plannerTaskDetails](plannerTaskDetails.md) 资源上的 `checklist` 属性包含的值过多。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-191">The `checklist` property on the [plannerTaskDetails](plannerTaskDetails.md) resource contains too many values.</span></span>                                                                                           |
| <span data-ttu-id="4b3d7-192">MaximumAssigneesInTasks</span><span class="sxs-lookup"><span data-stu-id="4b3d7-192">MaximumAssigneesInTasks</span></span>       | <span data-ttu-id="4b3d7-193">[plannerTask](plannerTask.md) 资源上的 `assignments` 属性包含的值过多。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-193">The `assignments` property on the [plannerTask](plannerTask.md) resource contains too many values.</span></span>                                                                                                       |

### <a name="412-precondition-failed"></a><span data-ttu-id="4b3d7-194">412 前提条件不满足 (Precondition Failed)</span><span class="sxs-lookup"><span data-stu-id="4b3d7-194">412 Precondition Failed</span></span> 

<span data-ttu-id="4b3d7-p121">Planner API 中的所有 `POST`、`PATCH` 和 `DELETE` 请求需要使用受请求约束的资源中可见的最后一个 etag 值指定 `If-Match` 标头。此外，如果请求中指定的 etag 值不再匹配服务中资源的版本，可以返回 412 状态代码。在这种情况下，客户端应该再次读取资源并获取新的 etag。</span><span class="sxs-lookup"><span data-stu-id="4b3d7-p121">All `POST`, `PATCH` and `DELETE` requests in Planner API require `If-Match` header to be specified with the last etag value seen of the resource that is subject to the request. Additionally, 412 status code can be returned if the etag value specified in the request no longer matches a version of the resource in the service. In this case, the clients should read the resource again and obtain a new etag.</span></span>

