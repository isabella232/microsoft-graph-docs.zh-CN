# <a name="use-the-outlook-mail-rest-api"></a><span data-ttu-id="8f29f-101">使用 Outlook 邮件 REST API</span><span class="sxs-lookup"><span data-stu-id="8f29f-101">Use the Outlook mail REST API</span></span>

<span data-ttu-id="8f29f-p101">Microsoft Graph 可让你的应用获得授权，访问个人或组织帐户中的用户的 Outlook 邮件数据。使用[适当的委派或应用程序权限](../../../concepts/permissions_reference.md)，你的应用程序可以访问已登录用户或租户中任何用户的邮件数据。邮件数据可以位于 Exchange Online 上的云中，作为 Office 365 的一部分，或位于[混合部署](../../../concepts/hybrid_rest_support.md)中的 Exchange 内部部署上。</span><span class="sxs-lookup"><span data-stu-id="8f29f-p101">Microsoft Graph lets your app get authorized access to a user's Outlook mail data in a personal or organization account. With the [appropriate delegated or application permissions](../../../concepts/permissions_reference.md), your app can access the mail data of the signed-in user or any user in a tenant. The mail data can be in the cloud on Exchange Online as part of Office 365, or on Exchange on-premises in a [hybrid deployment](../../../concepts/hybrid_rest_support.md).</span></span>

## <a name="using-the-mail-rest-api"></a><span data-ttu-id="8f29f-105">使用邮件 REST API</span><span class="sxs-lookup"><span data-stu-id="8f29f-105">Using the mail REST API</span></span>

<span data-ttu-id="8f29f-106">代表[用户](../resources/user.md)执行可由用户的 **id** 属性（唯一的 GUID）、电子邮件地址或`me`已登录用户的快捷方式别名标识的邮件 API 请求。</span><span class="sxs-lookup"><span data-stu-id="8f29f-106">Mail API requests are performed on behalf of a [user](../resources/user.md) which can be identified by the user's **id** property (a unique GUID), email address, or the `me` shortcut alias for the signed-in user.</span></span>

<span data-ttu-id="8f29f-p102">电子邮件由[邮件](../resources/message.md)资源表示，放在 [mailFolder](../resources/mailfolder.md) 中。邮件和邮件文件夹由其 **id** 属性标识，可通过 `GET` 操作获取。</span><span class="sxs-lookup"><span data-stu-id="8f29f-p102">Email messages are represented by the [message](../resources/message.md) resource and organized in a [mailFolder](../resources/mailfolder.md). Messages and mail folders are identified by their **id** property, obtainable from `GET` operations.</span></span>

><span data-ttu-id="8f29f-p103">**注意：** 通常，请不要假定邮箱内的**邮件**和 **mailFolder** 具有唯一且不可变的 ID。在执行如复制、移动或发送等某些操作后，它们可能会发生更改。</span><span class="sxs-lookup"><span data-stu-id="8f29f-p103">**Note:** In general, do not assume that **message** and **mailfolder** IDs are unique and immutable within a mailbox. They might change after certain actions such as copy, move, or send.</span></span>

<span data-ttu-id="8f29f-111">邮件正文可以是 HTML 格式或文本格式。</span><span class="sxs-lookup"><span data-stu-id="8f29f-111">Message bodies can be in HTML or text format.</span></span>

<span data-ttu-id="8f29f-112">您可以使用已知文件夹名称，如`Inbox`， `Drafts`， `SentItems`，或`DeletedItems`标识的所有用户的默认情况下存在特定邮件文件夹。</span><span class="sxs-lookup"><span data-stu-id="8f29f-112">You can use well-known folder names such as `Inbox`, `Drafts`, `SentItems`, or `DeletedItems` to identify certain mail folders that exist by default for all users.</span></span> <span data-ttu-id="8f29f-113">有关受支持的已知文件夹名称的列表，请参阅 [mailFolder 资源类型](../resources/mailfolder.md)。</span><span class="sxs-lookup"><span data-stu-id="8f29f-113">For a list of supported well-known folder names, see [mailFolder resource type](../resources/mailfolder.md).</span></span>

<span data-ttu-id="8f29f-114">例如，可以不第一个获取文件夹 ID 登录用户的 Outlook**发送项目**文件夹中收到消息：</span><span class="sxs-lookup"><span data-stu-id="8f29f-114">For example, you can get messages in the Outlook **Sent Items** folder of the signed-in user, without first getting the folder ID:</span></span>

```http
GET /me/mailFolders('SentItems')/messages?$select=sender,subject
```

## <a name="common-use-cases"></a><span data-ttu-id="8f29f-115">常见用例</span><span class="sxs-lookup"><span data-stu-id="8f29f-115">Common use cases</span></span>

<span data-ttu-id="8f29f-116">**邮件**资源公开如**类别**、**conversationId**、**标记**以及**重要性**等属性，这些属性对应于 UI 中的可用功能，允许应用自动化或与内置 Outlook 用户体验集成。</span><span class="sxs-lookup"><span data-stu-id="8f29f-116">The **message** resource exposes properties such as **categories**, **conversationId**, **flag**, and **importance** that correspond to features available in the UI, allowing apps to automate or integrate with the built-in Outlook user experience.</span></span>

<span data-ttu-id="8f29f-117">Microsoft Graph API 还提供支持邮件常见用例的方法和操作。</span><span class="sxs-lookup"><span data-stu-id="8f29f-117">The Microsoft Graph API also provides methods and actions that support common use cases of messages.</span></span>

| <span data-ttu-id="8f29f-118">用例</span><span class="sxs-lookup"><span data-stu-id="8f29f-118">Use cases</span></span> | <span data-ttu-id="8f29f-119">REST 资源</span><span class="sxs-lookup"><span data-stu-id="8f29f-119">REST resources</span></span> | <span data-ttu-id="8f29f-120">另请参阅</span><span class="sxs-lookup"><span data-stu-id="8f29f-120">See also</span></span> |
|:----------|:---------------|:---------|
| <span data-ttu-id="8f29f-121">**以用户为中心的操作**</span><span class="sxs-lookup"><span data-stu-id="8f29f-121">**User-centric actions**</span></span> | | |
| <span data-ttu-id="8f29f-122">起草、阅读、答复、转发、发送、更新或删除邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-122">Draft, read, reply, forward, send, update, or delete messages</span></span> | [<span data-ttu-id="8f29f-123">邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-123">message</span></span>](../resources/message.md) | [<span data-ttu-id="8f29f-124">邮件的方法</span><span class="sxs-lookup"><span data-stu-id="8f29f-124">Methods of message</span></span>](../resources/message.md#methods) |
| <span data-ttu-id="8f29f-125">代表邮箱所有者委托其他用户发送邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-125">Delegate another user to send messages on behalf of the mailbox owner</span></span> | [<span data-ttu-id="8f29f-126">邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-126">message</span></span>](../resources/message.md) | <span data-ttu-id="8f29f-127">正在设置[邮件](../resources/message.md)的**发件人**和**收件人**属性</span><span class="sxs-lookup"><span data-stu-id="8f29f-127">Setting the **from** and **sender** properties in a [message](../resources/message.md)</span></span> |
| <span data-ttu-id="8f29f-128">让用户先查看更重要的邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-128">Let user view more important messages first</span></span> | [<span data-ttu-id="8f29f-129">inferenceClassificationOverride</span><span class="sxs-lookup"><span data-stu-id="8f29f-129">inferenceClassificationOverride</span></span>](../resources/inferenceClassificationOverride.md) | [<span data-ttu-id="8f29f-130">重点收件箱</span><span class="sxs-lookup"><span data-stu-id="8f29f-130">Focused Inbox</span></span>](../resources/manage_focused_inbox.md) |
| <span data-ttu-id="8f29f-131">添加、获取或删除邮件的附件</span><span class="sxs-lookup"><span data-stu-id="8f29f-131">Add, get, or delete attachments of a message</span></span> | <span data-ttu-id="8f29f-132">[附件](../resources/attachment.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-132">[attachment](../resources/attachment.md),</span></span> <br> <span data-ttu-id="8f29f-133">[fileAttachment](../resources/fileattachment.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-133">[fileAttachment](../resources/fileattachment.md),</span></span> <br> <span data-ttu-id="8f29f-134">[itemAttachment](../resources/itemattachment.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-134">[itemAttachment](../resources/itemattachment.md),</span></span> <br> <span data-ttu-id="8f29f-135">[referenceAttachment](../resources/referenceattachment.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-135">[referenceAttachment](../resources/referenceattachment.md),</span></span> <br> [<span data-ttu-id="8f29f-136">邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-136">message</span></span>](../resources/message.md) | [<span data-ttu-id="8f29f-137">附件的方法</span><span class="sxs-lookup"><span data-stu-id="8f29f-137">Methods of attachment</span></span>](../resources/attachment.md#methods) |
| <span data-ttu-id="8f29f-138">获取或更新用户的自动答复、区域设置、时区或工作时间</span><span class="sxs-lookup"><span data-stu-id="8f29f-138">Get or update a user's automatic reply, locale, time zone, or working hours</span></span> | <span data-ttu-id="8f29f-139">[mailboxSettings](../resources/mailboxsettings.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-139">[mailboxSettings](../resources/mailboxsettings.md),</span></span> <br> <span data-ttu-id="8f29f-140">[automaticRepliesSetting](../resources/automaticrepliessetting.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-140">[automaticRepliesSetting](../resources/automaticrepliessetting.md),</span></span> <br> <span data-ttu-id="8f29f-141">[localeInfo](../resources/localeinfo.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-141">[localeInfo](../resources/localeinfo.md),</span></span> <br> [<span data-ttu-id="8f29f-142">workingHours</span><span class="sxs-lookup"><span data-stu-id="8f29f-142">workingHours</span></span>](../resources/workinghours.md) | <span data-ttu-id="8f29f-143">[获取用户的邮箱设置](../api/user_get_mailboxsettings.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-143">[Get user's mailbox settings](../api/user_get_mailboxsettings.md),</span></span> <br> [<span data-ttu-id="8f29f-144">更新用户的邮箱设置</span><span class="sxs-lookup"><span data-stu-id="8f29f-144">Update user's mailbox settings</span></span>](../api/user_update_mailboxsettings.md) |
| <span data-ttu-id="8f29f-145">要获取其他收件人的特殊状态，如外出邮件的提示</span><span class="sxs-lookup"><span data-stu-id="8f29f-145">Get MailTips of other recipients' special status, such as out-of-office</span></span> | <span data-ttu-id="8f29f-146">[用户](../resources/user.md)</span><span class="sxs-lookup"><span data-stu-id="8f29f-146">[user](../resources/user.md),</span></span> <br> [<span data-ttu-id="8f29f-147">邮件提示</span><span class="sxs-lookup"><span data-stu-id="8f29f-147">mailTips</span></span>](../resources/mailtips.md) | [<span data-ttu-id="8f29f-148">获取邮件提示</span><span class="sxs-lookup"><span data-stu-id="8f29f-148">Get MailTips</span></span>](../api/user_getmailtips.md) |
| <span data-ttu-id="8f29f-149">**邮件和文件夹管理**</span><span class="sxs-lookup"><span data-stu-id="8f29f-149">**Mail and folder management**</span></span> | | |
| <span data-ttu-id="8f29f-150">组织邮件文件夹层次结构中的邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-150">Organize messages in a mail folder hierarchy</span></span> | [<span data-ttu-id="8f29f-151">mailFolder</span><span class="sxs-lookup"><span data-stu-id="8f29f-151">mailFolder</span></span>](../resources/mailfolder.md)  | [<span data-ttu-id="8f29f-152">MailFolder 的方法</span><span class="sxs-lookup"><span data-stu-id="8f29f-152">Methods of mailFolder</span></span>](../resources/mailfolder.md#methods) |
| <span data-ttu-id="8f29f-153">搜索和筛选邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-153">Search and filter messages</span></span> | [<span data-ttu-id="8f29f-154">邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-154">message</span></span>](../resources/message.md) | [<span data-ttu-id="8f29f-155">查询参数</span><span class="sxs-lookup"><span data-stu-id="8f29f-155">Query parameters</span></span>](../../../concepts/query_parameters.md)  |
| <span data-ttu-id="8f29f-156">获取对文件夹中的邮件更改的通知</span><span class="sxs-lookup"><span data-stu-id="8f29f-156">Get notified of changes to messages in a folder</span></span> | [<span data-ttu-id="8f29f-157">订阅</span><span class="sxs-lookup"><span data-stu-id="8f29f-157">subscription</span></span>](../resources/subscription.md) | [<span data-ttu-id="8f29f-158">在 Microsoft Graph 中使用 Webhooks</span><span class="sxs-lookup"><span data-stu-id="8f29f-158">Working with webhooks in Microsoft Graph</span></span>](../resources/webhooks.md) |
| <span data-ttu-id="8f29f-159">同步邮件或邮件文件夹层次结构</span><span class="sxs-lookup"><span data-stu-id="8f29f-159">Synchronize messages or mail folder hierarchy</span></span> | [<span data-ttu-id="8f29f-160">邮件</span><span class="sxs-lookup"><span data-stu-id="8f29f-160">message</span></span>](../resources/message.md) | [<span data-ttu-id="8f29f-161">获取文件夹中邮件的增量更改</span><span class="sxs-lookup"><span data-stu-id="8f29f-161">Get incremental changes to messages in a folder</span></span>](../../../concepts/delta_query_messages.md) |
| <span data-ttu-id="8f29f-162">**应用开发**</span><span class="sxs-lookup"><span data-stu-id="8f29f-162">**App development**</span></span> | | |
| <span data-ttu-id="8f29f-163">将作为 Internet 邮件头的消息中添加自定义应用程序数据</span><span class="sxs-lookup"><span data-stu-id="8f29f-163">Add custom app data as Internet message headers of a message</span></span> | [<span data-ttu-id="8f29f-164">message</span><span class="sxs-lookup"><span data-stu-id="8f29f-164">message</span></span>](../resources/message.md) | <span data-ttu-id="8f29f-165">将自定义数据添加到邮件的**internetMessageHeaders**属性。</span><span class="sxs-lookup"><span data-stu-id="8f29f-165">Add custom data to the **internetMessageHeaders** property of the message.</span></span> |
| <span data-ttu-id="8f29f-166">通过使用扩展向邮件添加自定义应用数据</span><span class="sxs-lookup"><span data-stu-id="8f29f-166">Add custom app data to a message by using extensions</span></span> | <span data-ttu-id="8f29f-167">[openTypeExtension](../resources/opentypeextension.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-167">[openTypeExtension](../resources/opentypeextension.md),</span></span> <br>[<span data-ttu-id="8f29f-168">schemaExtension</span><span class="sxs-lookup"><span data-stu-id="8f29f-168">schemaExtension</span></span>](../resources/schemaextension.md) | [<span data-ttu-id="8f29f-169">使用扩展向资源添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="8f29f-169">Add custom data to resources using extensions</span></span>](../../../concepts/extensibility_overview.md) |
| <span data-ttu-id="8f29f-170">访问半公开的 Outlook MAPI 属性的自定义数据</span><span class="sxs-lookup"><span data-stu-id="8f29f-170">Access custom data for under-exposed Outlook MAPI properties</span></span> | <span data-ttu-id="8f29f-171">[SingleValueLegacyExtendedProperty](../resources/singlevaluelegacyextendedproperty.md)、</span><span class="sxs-lookup"><span data-stu-id="8f29f-171">[singleValueLegacyExtendedProperty](../resources/singlevaluelegacyextendedproperty.md),</span></span> <br> [<span data-ttu-id="8f29f-172">multiValueLegacyExtendedProperty</span><span class="sxs-lookup"><span data-stu-id="8f29f-172">multiValueLegacyExtendedProperty</span></span>](../resources/multivaluelegacyextendedproperty.md) | [<span data-ttu-id="8f29f-173">Outlook 扩展属性概述</span><span class="sxs-lookup"><span data-stu-id="8f29f-173">Outlook extended properties overview</span></span>](../resources/extended-properties-overview.md) |

## <a name="next-steps"></a><span data-ttu-id="8f29f-174">后续步骤</span><span class="sxs-lookup"><span data-stu-id="8f29f-174">Next steps</span></span>

<span data-ttu-id="8f29f-175">邮件 API 可以为你开辟与用户互动的新途径：</span><span class="sxs-lookup"><span data-stu-id="8f29f-175">The mail API can open up new ways for you to engage with users:</span></span>

- [<span data-ttu-id="8f29f-176">Outlook 邮件 API 概述</span><span class="sxs-lookup"><span data-stu-id="8f29f-176">Outlook mail API overview</span></span>](../../../concepts/outlook-mail-concept-overview.md)
- <span data-ttu-id="8f29f-177">向下钻取[邮件](../resources/message.md)和 [mailFolder](../resources/mailfolder.md) 资源的 [方法](../resources/message.md#methods)、[属性](../resources/message.md#properties)和[关系](../resources/message.md#relationships)。</span><span class="sxs-lookup"><span data-stu-id="8f29f-177">Drill down on the [methods](../resources/message.md#methods), [properties](../resources/message.md#properties), and [relationships](../resources/message.md#relationships) of the [message](../resources/message.md) and [mailFolder](../resources/mailfolder.md) resources.</span></span>
- <span data-ttu-id="8f29f-178">请尝试 [Graph 浏览器](https://developer.microsoft.com/graph/graph-explorer)中的 API。</span><span class="sxs-lookup"><span data-stu-id="8f29f-178">Try the API in the [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).</span></span>

<span data-ttu-id="8f29f-p105">需要更多灵感？请参阅[我们的一些合作伙伴如何使用 Microsoft Graph](https://developer.microsoft.com/graph/graph/examples#partners)。</span><span class="sxs-lookup"><span data-stu-id="8f29f-p105">Need more ideas? See [how some of our partners are using Microsoft Graph](https://developer.microsoft.com/graph/graph/examples#partners).</span></span>
