---
title: 导航 Microsoft Graph PowerShell SDK
description: Microsoft Graph PowerShell SDK 包含大量命令。 了解如何查找您想要实现的功能的正确命令。
localization_priority: Normal
author: jasonjoh
ms.openlocfilehash: ceb4b0f783d1ad9a24cfc196d4099d5e67b3f273
ms.sourcegitcommit: b70ee16cdf24daaec923acc477b86dbf76f2422b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/22/2020
ms.locfileid: "48193658"
---
# <a name="navigating-the-microsoft-graph-powershell-sdk"></a><span data-ttu-id="2e72d-104">导航 Microsoft Graph PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="2e72d-104">Navigating the Microsoft Graph PowerShell SDK</span></span>

<span data-ttu-id="2e72d-105">Microsoft Graph API 非常大，现在都在不断增长。</span><span class="sxs-lookup"><span data-stu-id="2e72d-105">The Microsoft Graph API is huge, and it's growing all the time.</span></span> <span data-ttu-id="2e72d-106">因此，Microsoft Graph PowerShell SDK 中的命令数也非常大。</span><span class="sxs-lookup"><span data-stu-id="2e72d-106">Because of this, the number of commands in the Microsoft Graph PowerShell SDK is also very large.</span></span> <span data-ttu-id="2e72d-107">为要实现的内容找到正确的命令可能会非常困难，尤其是在您尚不熟悉 Microsoft Graph 的情况下。</span><span class="sxs-lookup"><span data-stu-id="2e72d-107">Finding the right command for what you want to achieve can be challenging, especially if you're not already familiar with Microsoft Graph.</span></span> <span data-ttu-id="2e72d-108">让我们来看一些帮助查找特定命令的方法。</span><span class="sxs-lookup"><span data-stu-id="2e72d-108">Let's look at some ways to help find a particular command.</span></span>

## <a name="command-naming-conventions"></a><span data-ttu-id="2e72d-109">命令命名约定</span><span class="sxs-lookup"><span data-stu-id="2e72d-109">Command naming conventions</span></span>

<span data-ttu-id="2e72d-110">SDK 中的命令是直接从 [REST API](/graph/api/overview?view=graph-rest-1.0)生成的，因此这些名称受 API 影响。</span><span class="sxs-lookup"><span data-stu-id="2e72d-110">The commands in the SDK are generated directly from the [REST API](/graph/api/overview?view=graph-rest-1.0), so the names are influenced by the API.</span></span> <span data-ttu-id="2e72d-111">您无需了解使用此 SDK 的 API 的详细信息，但有助于理解命名约定。</span><span class="sxs-lookup"><span data-stu-id="2e72d-111">You don't have to understand the details of the API to use this SDK, but it helps to understand the naming convention.</span></span>

<span data-ttu-id="2e72d-112">PowerShell 命令是使用动词-名词对（例如或）命名 `Get-Command` 的 `Update-List` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-112">PowerShell commands are named using a verb-noun pair, such as `Get-Command` or `Update-List`.</span></span> <span data-ttu-id="2e72d-113">让我们从动词开始。</span><span class="sxs-lookup"><span data-stu-id="2e72d-113">Let's start with the verb.</span></span>

### <a name="command-verbs"></a><span data-ttu-id="2e72d-114">命令谓词</span><span class="sxs-lookup"><span data-stu-id="2e72d-114">Command verbs</span></span>

<span data-ttu-id="2e72d-115">对于基本 REST 操作，谓词由用于 API 的 HTTP 方法决定。</span><span class="sxs-lookup"><span data-stu-id="2e72d-115">For basic REST operations, the verb is determined by the HTTP method used for the API.</span></span>

| <span data-ttu-id="2e72d-116">HTTP 方法</span><span class="sxs-lookup"><span data-stu-id="2e72d-116">HTTP method</span></span> | <span data-ttu-id="2e72d-117">命令谓词</span><span class="sxs-lookup"><span data-stu-id="2e72d-117">Command verb</span></span> | <span data-ttu-id="2e72d-118">示例</span><span class="sxs-lookup"><span data-stu-id="2e72d-118">Example</span></span> |
|-------------|--------------|---|
| <span data-ttu-id="2e72d-119">GET</span><span class="sxs-lookup"><span data-stu-id="2e72d-119">GET</span></span>         | <span data-ttu-id="2e72d-120">获取</span><span class="sxs-lookup"><span data-stu-id="2e72d-120">Get</span></span>          | <span data-ttu-id="2e72d-121">`Get-MgUser` [API 参考](/graph/api/user-get?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="2e72d-121">`Get-MgUser` [API reference](/graph/api/user-get?view=graph-rest-1.0)</span></span> |
| <span data-ttu-id="2e72d-122">POST</span><span class="sxs-lookup"><span data-stu-id="2e72d-122">POST</span></span>        | <span data-ttu-id="2e72d-123">新式</span><span class="sxs-lookup"><span data-stu-id="2e72d-123">New</span></span>          | <span data-ttu-id="2e72d-124">`New-MgUserMessage` [API 参考](/graph/api/user-post-messages?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="2e72d-124">`New-MgUserMessage` [API reference](/graph/api/user-post-messages?view=graph-rest-1.0)</span></span> |
| <span data-ttu-id="2e72d-125">PUT</span><span class="sxs-lookup"><span data-stu-id="2e72d-125">PUT</span></span>         | <span data-ttu-id="2e72d-126">新式</span><span class="sxs-lookup"><span data-stu-id="2e72d-126">New</span></span>          | <span data-ttu-id="2e72d-127">`New-MgTeam` [API 参考](/graph/api/team-put-teams?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="2e72d-127">`New-MgTeam` [API reference](/graph/api/team-put-teams?view=graph-rest-1.0)</span></span> |
| <span data-ttu-id="2e72d-128">PATCH</span><span class="sxs-lookup"><span data-stu-id="2e72d-128">PATCH</span></span>       | <span data-ttu-id="2e72d-129">更新</span><span class="sxs-lookup"><span data-stu-id="2e72d-129">Update</span></span>       | <span data-ttu-id="2e72d-130">`Update-MgUserEvent` [API 参考](/graph/api/event-update?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="2e72d-130">`Update-MgUserEvent` [API reference](/graph/api/event-update?view=graph-rest-1.0)</span></span> |
| <span data-ttu-id="2e72d-131">DELETE</span><span class="sxs-lookup"><span data-stu-id="2e72d-131">DELETE</span></span>      | <span data-ttu-id="2e72d-132">删除</span><span class="sxs-lookup"><span data-stu-id="2e72d-132">Remove</span></span>       | <span data-ttu-id="2e72d-133">`Remove-MgDriveItem` [API 参考](/graph/api/driveitem-delete?view=graph-rest-1.0)</span><span class="sxs-lookup"><span data-stu-id="2e72d-133">`Remove-MgDriveItem` [API reference](/graph/api/driveitem-delete?view=graph-rest-1.0)</span></span> |

<span data-ttu-id="2e72d-134">对于函数和操作，稍微复杂一些。</span><span class="sxs-lookup"><span data-stu-id="2e72d-134">For functions and actions, it's a little more complicated.</span></span> <span data-ttu-id="2e72d-135">Microsoft Graph 中作为 OData 函数或操作实现的 Api 通常以至少一个谓词命名。</span><span class="sxs-lookup"><span data-stu-id="2e72d-135">APIs in Microsoft Graph that are implemented as OData functions or actions are typically named with at least a verb.</span></span> <span data-ttu-id="2e72d-136">相应的命令谓词基于函数或操作名称中的谓词。</span><span class="sxs-lookup"><span data-stu-id="2e72d-136">The corresponding command's verb is based on the verb in the function or action name.</span></span> <span data-ttu-id="2e72d-137">但是，PowerShell 中的命令谓词必须符合特定的 [命名规则](/powershell/scripting/developer/cmdlet/approved-verbs-for-windows-powershell-commands)，因此这可能导致不直观的名称到命令映射。</span><span class="sxs-lookup"><span data-stu-id="2e72d-137">However, command verbs in PowerShell have to conform to specific [naming rules](/powershell/scripting/developer/cmdlet/approved-verbs-for-windows-powershell-commands), so this can result in non-intuitive name-to-command mappings.</span></span>

<span data-ttu-id="2e72d-138">我们来看一些示例。</span><span class="sxs-lookup"><span data-stu-id="2e72d-138">Let's look at some examples.</span></span> <span data-ttu-id="2e72d-139">[GetSchedule](/graph/api/calendar-getschedule?view=graph-rest-1.0) API 使用 `get` ，并且 `Get` 是已批准的 PowerShell 谓词，因此它的命令是 `Get-MgUserCalendarSchedule` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-139">The [getSchedule](/graph/api/calendar-getschedule?view=graph-rest-1.0) API uses `get`, and `Get` is an approved PowerShell verb, so it's command is `Get-MgUserCalendarSchedule`.</span></span> <span data-ttu-id="2e72d-140">另一方面，在事件上的 [取消](/graph/api/event-cancel?view=graph-rest-beta) API 使用未经批准的谓词 `cancel` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-140">The [cancel](/graph/api/event-cancel?view=graph-rest-beta) API on an event on the other hand, uses a non-approved verb `cancel`.</span></span> <span data-ttu-id="2e72d-141">"取消" 或 "不再" 的批准动词是 `Stop` ，因此它的命令是 `Stop-MgUserEvent` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-141">The approved verb for cancelling or discontinuing somethign is `Stop`, so it's command is `Stop-MgUserEvent`.</span></span> <span data-ttu-id="2e72d-142">最后， [snoozeReminder](/graph/api/event-snoozereminder?view=graph-rest-1.0) API 的动词 `snooze` 没有经过 PowerShell 批准的等效项。</span><span class="sxs-lookup"><span data-stu-id="2e72d-142">Finally, the [snoozeReminder](/graph/api/event-snoozereminder?view=graph-rest-1.0) API's verb, `snooze`, has no PowerShell-approved equivalent.</span></span> <span data-ttu-id="2e72d-143">对于 API 这样的 API，SDK 使用动词 `Invoke` ，因此 api 的命令是 `Invoke-MgSnoozeUserEventReminder` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-143">For API's like that, the SDK uses the verb `Invoke`, so that API's command is `Invoke-MgSnoozeUserEventReminder`.</span></span>

### <a name="command-nouns"></a><span data-ttu-id="2e72d-144">命令名词</span><span class="sxs-lookup"><span data-stu-id="2e72d-144">Command nouns</span></span>

<span data-ttu-id="2e72d-145">到目前为止，你可能已注意到 SDK 的命令中的所有名词都以开头 `Mg` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-145">By now you may have noticed that all nouns in the SDK's commands start with `Mg`.</span></span> <span data-ttu-id="2e72d-146">此前缀有助于避免与其他 PowerShell 模块发生命名冲突。</span><span class="sxs-lookup"><span data-stu-id="2e72d-146">This prefix helps to avoid naming conflicts with other PowerShell modules.</span></span> <span data-ttu-id="2e72d-147">明确这一点后， `Get-MgUser` 使用类似于获取用户的命令将会有意义。</span><span class="sxs-lookup"><span data-stu-id="2e72d-147">With that in mind, it should make sense that commands like `Get-MgUser` are used to get a user.</span></span> <span data-ttu-id="2e72d-148">和以下 PowerShell 约定（尽管名词是单数形式），如果没有请求特定的实例，则这些相同的命令可能会返回多个结果。</span><span class="sxs-lookup"><span data-stu-id="2e72d-148">And following PowerShell convention, even though the noun is singular, those same commands can return multiple results if no specific instance is requested.</span></span>

<span data-ttu-id="2e72d-149">但像或这样的命令呢 `Get-MgUserMessage` `Get-MgUserMailFolderMessage` ？</span><span class="sxs-lookup"><span data-stu-id="2e72d-149">But what about commands like `Get-MgUserMessage` or `Get-MgUserMailFolderMessage`?</span></span> <span data-ttu-id="2e72d-150">这两个类都将获取 [message](/graph/api/resources/message?view=graph-rest-1.0) 对象，因此为什么不会这么 `Get-MgMessage` 做呢？</span><span class="sxs-lookup"><span data-stu-id="2e72d-150">Both of these get a [message](/graph/api/resources/message?view=graph-rest-1.0) object, so why not `Get-MgMessage`?</span></span> <span data-ttu-id="2e72d-151">答案来自 [获取邮件 API](/graph/api/message-get?view=graph-rest-1.0)。</span><span class="sxs-lookup"><span data-stu-id="2e72d-151">The answer comes from the [get message API](/graph/api/message-get?view=graph-rest-1.0).</span></span>

<span data-ttu-id="2e72d-152">查看此 API 的 HTTP 请求。</span><span class="sxs-lookup"><span data-stu-id="2e72d-152">Look at the HTTP requests for this API.</span></span> <span data-ttu-id="2e72d-153">忽略 `/me` URL 中的请求，有两种其他方法可调用此 API。</span><span class="sxs-lookup"><span data-stu-id="2e72d-153">Ignoring the requests with `/me` in the URL, there are two other ways to call this API.</span></span>

```http
GET /users/{id | userPrincipalName}/messages/{id}
GET /users/{id | userPrincipalName}/mailFolders/{id}/messages/{id}
```

<span data-ttu-id="2e72d-154">与名词匹配的路径。</span><span class="sxs-lookup"><span data-stu-id="2e72d-154">The paths match to the nouns.</span></span> <span data-ttu-id="2e72d-155">对于第一个窗体，从开始 `users` ，然后 `messages` ，命令是 `Get-MgUserMessage` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-155">For the first form, you start with `users`, then `messages`, so the command is `Get-MgUserMessage`.</span></span> <span data-ttu-id="2e72d-156">在第二个窗体中，首先 `users` 是，然后 `mailFolders` 是邮件，因此命令是 `Get-MgUserMailFolderMessage` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-156">In the second form, you start with `users`, then `mailFolders`, then messages, so the command is `Get-MgUserMailFolderMessage`.</span></span>

<span data-ttu-id="2e72d-157">查看此内容的另一种方法是拥有或包含哪些内容。</span><span class="sxs-lookup"><span data-stu-id="2e72d-157">Another way of looking at this is what owns or contains what.</span></span> <span data-ttu-id="2e72d-158">用户拥有邮件文件夹，邮件文件夹中包含邮件。</span><span class="sxs-lookup"><span data-stu-id="2e72d-158">The user owns mail folders, and mail folders contain messages.</span></span> <span data-ttu-id="2e72d-159">添加前缀并获取 `Get-MgUserMailFolderMessage` 。</span><span class="sxs-lookup"><span data-stu-id="2e72d-159">Add the prefix and you get `Get-MgUserMailFolderMessage`.</span></span>

## <a name="finding-available-commands"></a><span data-ttu-id="2e72d-160">查找可用命令</span><span class="sxs-lookup"><span data-stu-id="2e72d-160">Finding available commands</span></span>

<span data-ttu-id="2e72d-161">有时只知道命名约定并不能猜测正确的命令。</span><span class="sxs-lookup"><span data-stu-id="2e72d-161">Sometimes just knowing the naming conventions isn't enough to guess the right command.</span></span> <span data-ttu-id="2e72d-162">在这种情况下，可以使用 `Get-Command` 命令在 SDK 中搜索可用命令。</span><span class="sxs-lookup"><span data-stu-id="2e72d-162">In this case, you can use the `Get-Command` command to search the available commands in the SDK.</span></span> <span data-ttu-id="2e72d-163">例如，如果您要查找与 Microsoft 团队相关的命令，则可以运行以下命令。</span><span class="sxs-lookup"><span data-stu-id="2e72d-163">For example, if you're looking for commands related to Microsoft Teams, you can run the following command.</span></span>

```powershell
Get-Command -Module Microsoft.Graph* *team*
```
