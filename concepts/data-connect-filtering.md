---
title: Microsoft Graph 数据连接支持用户选择和筛选
description: 介绍了如何使用 Microsoft Graph 数据连接来选择用户以提取其数据，以及筛选返回的数据。
author: tlenig
localization_priority: Priority
ms.prod: data-connect
ms.openlocfilehash: 0c5ec59fc42ed2e5a0b21631dd3c501ae9c4bfe1
ms.sourcegitcommit: 66a52d2e63cf3447ec50bd28e562d99e7c344814
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/31/2020
ms.locfileid: "43062594"
---
# <a name="user-selection-and-filtering-microsoft-graph-data-connect-supports"></a><span data-ttu-id="844ff-103">Microsoft Graph 数据连接支持用户选择和筛选</span><span class="sxs-lookup"><span data-stu-id="844ff-103">User selection and filtering Microsoft Graph data connect supports</span></span>

<span data-ttu-id="844ff-104">你可以使用 Microsoft Graph 数据连接来选择要提取其数据的用户，并包含筛选器以限制返回的数据。</span><span class="sxs-lookup"><span data-stu-id="844ff-104">You can use Microsoft Graph data connect to select the users that you want to extract data for, and to include filters to limit the data returned.</span></span> <span data-ttu-id="844ff-105">本文介绍数据连接提供的用户选择选项，以及它支持的筛选功能。</span><span class="sxs-lookup"><span data-stu-id="844ff-105">This article describes the user selection options that data connect provides and the filtering that it supports.</span></span> 

## <a name="user-selection"></a><span data-ttu-id="844ff-106">用户选择</span><span class="sxs-lookup"><span data-stu-id="844ff-106">User selection</span></span> 

<span data-ttu-id="844ff-107">可以针对一组用户运行管道。</span><span class="sxs-lookup"><span data-stu-id="844ff-107">You can run pipelines on a set of users.</span></span> <span data-ttu-id="844ff-108">下面是适用于用户选择的选项：</span><span class="sxs-lookup"><span data-stu-id="844ff-108">The following are the options for user selection:</span></span>
- <span data-ttu-id="844ff-109">组织内的所有用户</span><span class="sxs-lookup"><span data-stu-id="844ff-109">All users within the organization</span></span>
- <span data-ttu-id="844ff-110">对组织内最多 10 个用户组运行</span><span class="sxs-lookup"><span data-stu-id="844ff-110">Up to 10 groups of users within the organization to run on</span></span> 
- <span data-ttu-id="844ff-111">基于由 Azure Active Directory 用户属性组成的谓词的一组用户。</span><span class="sxs-lookup"><span data-stu-id="844ff-111">A set of users based on a predicate consisting of Azure Active Directory user properties</span></span>

<span data-ttu-id="844ff-112">在 Azure 数据工厂复制活动的 SourceDataSet 中指定用户选择。</span><span class="sxs-lookup"><span data-stu-id="844ff-112">Specify your user selection in the SourceDataSet of the Azure Data Factory copy activity.</span></span> <span data-ttu-id="844ff-113">若要针对组列表运行，请在 **typeProperties** 下添加一个新字段 **allowedGroups**，并将此字段设置为最多 10 个组的列表，**对象 Id** 由逗号分隔。</span><span class="sxs-lookup"><span data-stu-id="844ff-113">To run on a list of groups, add a new field **allowedGroups** under **typeProperties** and set this to a list of up to 10 groups' **Object Ids** separated by commas.</span></span> <span data-ttu-id="844ff-114">如果默认情况下未指定组，则将为整个组织提取数据。</span><span class="sxs-lookup"><span data-stu-id="844ff-114">If no groups are specified by default, data will be extracted for the entire organization.</span></span> 

<span data-ttu-id="844ff-115">若要指定针对整个租户运行的谓词，请在 **typeProperties** 下添加一个新字段 **userScopeFilterUri**，并将此字段设置为该谓词。</span><span class="sxs-lookup"><span data-stu-id="844ff-115">To specify a predicate to run on the entire tenant, add a new field **userScopeFilterUri** under **typeProperties** and set this to the predicate.</span></span> <span data-ttu-id="844ff-116">谓词格式应与 Microsoft Graph API 的查询格式匹配。</span><span class="sxs-lookup"><span data-stu-id="844ff-116">The predicate format should match the query format of Microsoft Graph APIs.</span></span> <span data-ttu-id="844ff-117">例如，如果要仅选择在财务部门工作的用户，你可以使用 `https://graph.microsoft.com/v1.0/users?$filter=Department eq 'Finance'`。</span><span class="sxs-lookup"><span data-stu-id="844ff-117">For example, if you want to limit the selection to users who work in the Finance department, you can use `https://graph.microsoft.com/v1.0/users?$filter=Department eq 'Finance'`.</span></span> <span data-ttu-id="844ff-118">如果要仅选择一个用户，可使用 `https://graph.microsoft.com/v1.0/users?$filter=mail eq 'contosouser1@contoso.com'`。</span><span class="sxs-lookup"><span data-stu-id="844ff-118">If you want to limit the selection to one user, you can use `https://graph.microsoft.com/v1.0/users?$filter=mail eq 'contosouser1@contoso.com'`.</span></span>

<span data-ttu-id="844ff-119">查询将仅返回你所查询的 Office 365 组织内的用户。</span><span class="sxs-lookup"><span data-stu-id="844ff-119">Your query will only return users within the Office 365 organization that you're querying.</span></span> <span data-ttu-id="844ff-120">将不会返回来宾用户和非用户邮箱。</span><span class="sxs-lookup"><span data-stu-id="844ff-120">Guest users and non-user mailboxes will not be returned.</span></span>

## <a name="filtering"></a><span data-ttu-id="844ff-121">筛选</span><span class="sxs-lookup"><span data-stu-id="844ff-121">Filtering</span></span> 

<span data-ttu-id="844ff-122">可以使用日期时间属性来限制查询提取到的结果。</span><span class="sxs-lookup"><span data-stu-id="844ff-122">You can limit the results extracted for your query using DateTime properties.</span></span> <span data-ttu-id="844ff-123">根据所请求数据的类型，可能需要日期时间筛选器。</span><span class="sxs-lookup"><span data-stu-id="844ff-123">Depending on the type of data requested, a DateTime filter might be required.</span></span> <span data-ttu-id="844ff-124">日期时间筛选器使用的属性由 Azure 数据工厂复制活动的 SourceDataSet 提供。</span><span class="sxs-lookup"><span data-stu-id="844ff-124">The DateTime filter is provided using properties in the SourceDataSet of the Azure Data Factory copy activity.</span></span> <span data-ttu-id="844ff-125">若要指定日期时间筛选器，请在 **typeProperties** 下添加一个新字段 **dateFilterColumn**，并将此字段设置为下表中支持筛选的属性之一。</span><span class="sxs-lookup"><span data-stu-id="844ff-125">To specify a DateTime filter, add a new field **dateFilterColumn** under **typeProperties** and set this to one of the properties that support filtering in the following table.</span></span> <span data-ttu-id="844ff-126">接着，添加表示日期时间值的 **startTime** 和 **endTime**，系统将依据这些值对属性进行筛选。</span><span class="sxs-lookup"><span data-stu-id="844ff-126">Next, add a **startTime** and **endTime** that represent the DateTime values that the property will be filtered upon.</span></span> 

<span data-ttu-id="844ff-127">以下数据集需要针对相应的其中一个日期时间属性提供筛选器。</span><span class="sxs-lookup"><span data-stu-id="844ff-127">The following datasets require a filter to be provided on one of the corresponding DateTime properties.</span></span>

| <span data-ttu-id="844ff-128">数据集名称</span><span class="sxs-lookup"><span data-stu-id="844ff-128">Dataset name</span></span>                                                   | <span data-ttu-id="844ff-129">支持筛选的属性</span><span class="sxs-lookup"><span data-stu-id="844ff-129">Properties that support filtering</span></span>                                           | 
|----------------------------------------------------------------|-----------------------------------------------------------------------------| 
| <span data-ttu-id="844ff-130">BasicDataSet_v0.Event_v0</span><span class="sxs-lookup"><span data-stu-id="844ff-130">BasicDataSet_v0.Event_v0</span></span><br><span data-ttu-id="844ff-131">BasicDataSet_v0.Event_v1</span><span class="sxs-lookup"><span data-stu-id="844ff-131">BasicDataSet_v0.Event_v1</span></span>           | <span data-ttu-id="844ff-132">CreatedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-132">CreatedDateTime</span></span><br><span data-ttu-id="844ff-133">LastModifiedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-133">LastModifiedDateTime</span></span>                                     | 
| <span data-ttu-id="844ff-134">BasicDataSet_v0.Message_v0</span><span class="sxs-lookup"><span data-stu-id="844ff-134">BasicDataSet_v0.Message_v0</span></span><br><span data-ttu-id="844ff-135">BasicDataSet_v0.Message_v1</span><span class="sxs-lookup"><span data-stu-id="844ff-135">BasicDataSet_v0.Message_v1</span></span>       | <span data-ttu-id="844ff-136">CreatedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-136">CreatedDateTime</span></span><br><span data-ttu-id="844ff-137">LastModifiedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-137">LastModifiedDateTime</span></span><br><span data-ttu-id="844ff-138">ReceivedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-138">ReceivedDateTime</span></span><br><span data-ttu-id="844ff-139">SentDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-139">SentDateTime</span></span> | 
| <span data-ttu-id="844ff-140">BasicDataSet_v0.SentItem_v0</span><span class="sxs-lookup"><span data-stu-id="844ff-140">BasicDataSet_v0.SentItem_v0</span></span><br><span data-ttu-id="844ff-141">BasicDataSet_v0.SentItem_v1</span><span class="sxs-lookup"><span data-stu-id="844ff-141">BasicDataSet_v0.SentItem_v1</span></span>     | <span data-ttu-id="844ff-142">CreatedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-142">CreatedDateTime</span></span><br><span data-ttu-id="844ff-143">LastModifiedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-143">LastModifiedDateTime</span></span><br><span data-ttu-id="844ff-144">ReceivedDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-144">ReceivedDateTime</span></span><br><span data-ttu-id="844ff-145">SentDateTime</span><span class="sxs-lookup"><span data-stu-id="844ff-145">SentDateTime</span></span> |

><span data-ttu-id="844ff-146">**注意：** 请求 BasicDataSet_v0.CalendarView_v0 的管道也需要日期时间筛选器，但 SourceDataSet 中未指定 **dateFilterColumn**。</span><span class="sxs-lookup"><span data-stu-id="844ff-146">**Note** Pipelines requesting BasicDataSet_v0.CalendarView_v0 also require a DateTime filter, but no **dateFilterColumn** is specified in the SourceDataSet.</span></span> <span data-ttu-id="844ff-147">但是，需要 **startTime** 和 **endTime**，且只提供了在 **startTime** 之后开始并在 **endTime** 之前完成的事件。</span><span class="sxs-lookup"><span data-stu-id="844ff-147">However, a **startTime** and **endTime** are required and only events that begin after the **startTime** and finish before the **endTime** are provided.</span></span>

## <a name="next-steps"></a><span data-ttu-id="844ff-148">后续步骤</span><span class="sxs-lookup"><span data-stu-id="844ff-148">Next Steps</span></span> 

<span data-ttu-id="844ff-149">有关如何修改选择的用户以在数据连接管道中进行提取和筛选的详细信息，请参阅 [Azure 数据工厂 Office 365 连接器文档](https://docs.microsoft.com/azure/data-factory/connector-office-365)。</span><span class="sxs-lookup"><span data-stu-id="844ff-149">For more information about how to modify the user selected for extractoin and filtering in data connect pipelines, see the [Azure Data Factory Office 365 connector documentation](https://docs.microsoft.com/azure/data-factory/connector-office-365).</span></span>  

  
