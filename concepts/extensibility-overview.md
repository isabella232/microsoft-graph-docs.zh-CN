---
title: 使用扩展向资源添加自定义数据
description: Microsoft Graph 提供单一 API 终结点，以便用户能够通过大量资源（如 user 和 message）访问以人为中心的丰富数据和见解。 你还可以使用自己的应用程序数据扩展 Microsoft Graph。 无需使用外部数据存储，即可向 Microsoft Graph 资源添加自定义属性。
author: dkershaw10
localization_priority: Priority
ms.custom: graphiamtop20
ms.openlocfilehash: 856f427e864eb4fa6a16c1ea758288523ae23c52
ms.sourcegitcommit: b1e1f614299f668453916bd85761ef7b6c8d6eff
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/05/2019
ms.locfileid: "37969764"
---
# <a name="add-custom-data-to-resources-using-extensions"></a><span data-ttu-id="eecf3-105">使用扩展向资源添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="eecf3-105">Add custom data to resources using extensions</span></span>

<span data-ttu-id="eecf3-106">Microsoft Graph 提供单一 API 终结点，以便用户能够通过大量资源（如 [user](/graph/api/resources/user?view=graph-rest-1.0) 和 [message](/graph/api/resources/message?view=graph-rest-1.0)）访问以人为中心的丰富数据和见解。</span><span class="sxs-lookup"><span data-stu-id="eecf3-106">Microsoft Graph provides a single API endpoint that gives you access to rich people-centric data and insights through a number of resources such as [user](/graph/api/resources/user?view=graph-rest-1.0) and [message](/graph/api/resources/message?view=graph-rest-1.0).</span></span> <span data-ttu-id="eecf3-107">你还可以使用自己的应用程序数据扩展 Microsoft Graph。</span><span class="sxs-lookup"><span data-stu-id="eecf3-107">You can also extend Microsoft Graph with your own application data.</span></span> <span data-ttu-id="eecf3-108">无需使用外部数据存储，即可向 Microsoft Graph 资源添加自定义属性。</span><span class="sxs-lookup"><span data-stu-id="eecf3-108">You can add custom properties to Microsoft Graph resources without requiring an external data store.</span></span>

<span data-ttu-id="eecf3-109">例如，可能会决定扩展 **user** 资源，让应用处于轻量级水平，并将应用专属的用户配置文件数据存储在 Microsoft Graph 中。</span><span class="sxs-lookup"><span data-stu-id="eecf3-109">For example, you might decide to keep your app lightweight and store app-specific user profile data in Microsoft Graph by extending the **user** resource.</span></span> <span data-ttu-id="eecf3-110">或者，不妨保留应用的现有用户配置文件存储，并仅将应用专属的存储标识符添加到 **user** 资源。</span><span class="sxs-lookup"><span data-stu-id="eecf3-110">Alternatively, you might want to retain your app’s existing user profile store, and simply add an app-specific store identifier to the **user** resource.</span></span>

<span data-ttu-id="eecf3-p104">Microsoft Graph 提供两种类型的扩展。选择最适合应用程序需求的扩展类型：</span><span class="sxs-lookup"><span data-stu-id="eecf3-p104">Microsoft Graph offers two types of extensions. Choose the extension type that best suits your application needs:</span></span>

- <span data-ttu-id="eecf3-113">**开放扩展**：开发人员入门的良好方法。</span><span class="sxs-lookup"><span data-stu-id="eecf3-113">**Open extensions**: A good way for developers to get started.</span></span>
- <span data-ttu-id="eecf3-114">**架构扩展**：对于那些关心存储类型化数据，使其架构可发现和可共享，能够进行筛选以及将来能够执行输入数据验证和授权的开发人员而言，这是一种更通用的机制。</span><span class="sxs-lookup"><span data-stu-id="eecf3-114">**Schema extensions**: A more versatile mechanism for developers who care about storing typed data, making their schema discoverable and shareable, being able to filter, and in the future, being able to perform input data validation and authorization.</span></span>

> <span data-ttu-id="eecf3-115">**重要说明：** 不能使用扩展存储敏感的个人身份信息，例如帐户凭据、政府标识号、持卡人数据、财务帐户数据、医疗保健信息或敏感的背景信息。</span><span class="sxs-lookup"><span data-stu-id="eecf3-115">**Important:** You should not use extensions to store sensitive personally identifiable information, such as account credentials, government identification numbers, cardholder data, financial account data, healthcare information, or sensitive background information.</span></span>

## <a name="supported-resources"></a><span data-ttu-id="eecf3-116">支持的资源</span><span class="sxs-lookup"><span data-stu-id="eecf3-116">Supported resources</span></span>

<span data-ttu-id="eecf3-117">下表列出了支持开放扩展和架构扩展的资源，并指明是处于正式版（GA - 在 v1.0 和 beta 终结点中均可用）阶段，还是处于预览版（仅在 beta 终结点中可用）阶段。</span><span class="sxs-lookup"><span data-stu-id="eecf3-117">The following table lists the resources that support open and schema extensions, and indicates whether they have reached general availability (GA - available in both the v1.0 and beta endpoints) or are in preview (available only in the beta endpoint).</span></span>

|<span data-ttu-id="eecf3-118">资源</span><span class="sxs-lookup"><span data-stu-id="eecf3-118">Resource</span></span> |<span data-ttu-id="eecf3-119">开放扩展</span><span class="sxs-lookup"><span data-stu-id="eecf3-119">Open extensions</span></span> |<span data-ttu-id="eecf3-120">架构扩展</span><span class="sxs-lookup"><span data-stu-id="eecf3-120">Schema extensions</span></span> |
|:------- |:------ |:------ |
| [<span data-ttu-id="eecf3-121">管理单元</span><span class="sxs-lookup"><span data-stu-id="eecf3-121">Administrative unit</span></span>](/graph/api/resources/administrativeunit?view=graph-rest-beta) | <span data-ttu-id="eecf3-122">仅供预览</span><span class="sxs-lookup"><span data-stu-id="eecf3-122">Preview only</span></span> | <span data-ttu-id="eecf3-123">仅供预览</span><span class="sxs-lookup"><span data-stu-id="eecf3-123">Preview only</span></span> |
| [<span data-ttu-id="eecf3-124">日历事件</span><span class="sxs-lookup"><span data-stu-id="eecf3-124">Calendar event</span></span>](/graph/api/resources/event?view=graph-rest-1.0) | <span data-ttu-id="eecf3-125">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-125">GA</span></span> | <span data-ttu-id="eecf3-126">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-126">GA</span></span> |
| [<span data-ttu-id="eecf3-127">设备</span><span class="sxs-lookup"><span data-stu-id="eecf3-127">Device</span></span>](/graph/api/resources/device?view=graph-rest-1.0) | <span data-ttu-id="eecf3-128">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-128">GA</span></span> | <span data-ttu-id="eecf3-129">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-129">GA</span></span> |
| [<span data-ttu-id="eecf3-130">组</span><span class="sxs-lookup"><span data-stu-id="eecf3-130">Group</span></span>](/graph/api/resources/group?view=graph-rest-1.0) | <span data-ttu-id="eecf3-131">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-131">GA</span></span> | <span data-ttu-id="eecf3-132">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-132">GA</span></span> |
| [<span data-ttu-id="eecf3-133">组日历事件</span><span class="sxs-lookup"><span data-stu-id="eecf3-133">Group calendar event</span></span>](/graph/api/resources/event?view=graph-rest-1.0) | <span data-ttu-id="eecf3-134">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-134">GA</span></span> | <span data-ttu-id="eecf3-135">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-135">GA</span></span> |
| [<span data-ttu-id="eecf3-136">组对话帖子</span><span class="sxs-lookup"><span data-stu-id="eecf3-136">Group conversation post</span></span>](/graph/api/resources/post?view=graph-rest-1.0) | <span data-ttu-id="eecf3-137">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-137">GA</span></span> | <span data-ttu-id="eecf3-138">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-138">GA</span></span> |
| [<span data-ttu-id="eecf3-139">邮件</span><span class="sxs-lookup"><span data-stu-id="eecf3-139">Message</span></span>](/graph/api/resources/message?view=graph-rest-1.0) | <span data-ttu-id="eecf3-140">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-140">GA</span></span> | <span data-ttu-id="eecf3-141">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-141">GA</span></span> |
| [<span data-ttu-id="eecf3-142">组织</span><span class="sxs-lookup"><span data-stu-id="eecf3-142">Organization</span></span>](/graph/api/resources/organization?view=graph-rest-1.0) | <span data-ttu-id="eecf3-143">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-143">GA</span></span> | <span data-ttu-id="eecf3-144">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-144">GA</span></span> |
| [<span data-ttu-id="eecf3-145">个人联系人</span><span class="sxs-lookup"><span data-stu-id="eecf3-145">Personal contact</span></span>](/graph/api/resources/contact?view=graph-rest-1.0)| <span data-ttu-id="eecf3-146">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-146">GA</span></span> | <span data-ttu-id="eecf3-147">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-147">GA</span></span> |
| [<span data-ttu-id="eecf3-148">用户</span><span class="sxs-lookup"><span data-stu-id="eecf3-148">User</span></span>](/graph/api/resources/user?view=graph-rest-1.0) | <span data-ttu-id="eecf3-149">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-149">GA</span></span> | <span data-ttu-id="eecf3-150">GA</span><span class="sxs-lookup"><span data-stu-id="eecf3-150">GA</span></span> |

<span data-ttu-id="eecf3-151">使用工作或学校帐户登录时，可以对所有这些资源使用扩展。</span><span class="sxs-lookup"><span data-stu-id="eecf3-151">You can use extensions on all these resources when signed in with a work or school account.</span></span> <span data-ttu-id="eecf3-152">此外，使用个人帐户登录时，可以对“**事件**”、“**帖子**”、“**组**”、“**邮件**”、“**联系人**”和“**用户**”资源使用扩展。</span><span class="sxs-lookup"><span data-stu-id="eecf3-152">In addition, you can use extensions on the **event**, **post**, **group**, **message**, **contact**, and **user** resources when signed in with a personal account.</span></span>

## <a name="open-extensions"></a><span data-ttu-id="eecf3-153">开放扩展</span><span class="sxs-lookup"><span data-stu-id="eecf3-153">Open extensions</span></span>

<span data-ttu-id="eecf3-154">[开放扩展](/graph/api/resources/opentypeextension?view=graph-rest-1.0)（以前称为 Office 365 数据扩展）是提供灵活方法将非类型化应用数据直接添加到资源实例的[开放类型](https://www.odata.org/getting-started/advanced-tutorial/#openType)。</span><span class="sxs-lookup"><span data-stu-id="eecf3-154">[Open extensions](/graph/api/resources/opentypeextension?view=graph-rest-1.0) (formerly known as Office 365 data extensions) are [open types](https://www.odata.org/getting-started/advanced-tutorial/#openType) that offer a flexible way to add untyped app data directly to a resource instance.</span></span>

> [!VIDEO https://www.youtube-nocookie.com/embed/ibdlADb8IZc]

<span data-ttu-id="eecf3-155">开放扩展及其自定义数据可通过资源实例的 **extensions** 导航属性进行访问。</span><span class="sxs-lookup"><span data-stu-id="eecf3-155">Open extensions, together with their custom data, are accessible through the **extensions** navigation property of the resource instance.</span></span>
<span data-ttu-id="eecf3-156">**extensionName** 属性是开放扩展中的_预定义_唯一可写属性。</span><span class="sxs-lookup"><span data-stu-id="eecf3-156">The **extensionName** property is the only _pre-defined_, writable property in an open extension.</span></span> <span data-ttu-id="eecf3-157">创建开放扩展时，必须为 **extensionName** 属性分配在租户内唯一的名称。</span><span class="sxs-lookup"><span data-stu-id="eecf3-157">When creating an open extension, you must assign the **extensionName** property a name that is unique within the tenant.</span></span>

<span data-ttu-id="eecf3-158">为此，一种方法是使用反向域名系统 (DNS) 格式，此格式依赖_用户自己的域_。例如，`Com.Contoso.ContactInfo`。</span><span class="sxs-lookup"><span data-stu-id="eecf3-158">One way to do this is to use a reverse domain name system (DNS) format that is dependent on _your own domain_, for example, `Com.Contoso.ContactInfo`.</span></span>

<span data-ttu-id="eecf3-159">请勿在扩展名称中使用 Microsoft 域（`Com.Microsoft` 或 `Com.OnMicrosoft`）。</span><span class="sxs-lookup"><span data-stu-id="eecf3-159">Do not use the Microsoft domain (`Com.Microsoft` or `Com.OnMicrosoft`) in an extension name.</span></span>

<span data-ttu-id="eecf3-160">可以在资源实例中[创建开放扩展](/graph/api/opentypeextension-post-opentypeextension?view=graph-rest-1.0)，并将自定义数据存储到其中，全都通过同一操作完成（请注意受支持的部分资源的[已知限制](known-issues.md#extensions)）。</span><span class="sxs-lookup"><span data-stu-id="eecf3-160">You can [create an open extension](/graph/api/opentypeextension-post-opentypeextension?view=graph-rest-1.0) in a resource instance and store custom data to it all in the same operation (note [known limitation](known-issues.md#extensions) for some of the supported resources).</span></span>

<span data-ttu-id="eecf3-161">随后，可以[读取](/graph/api/opentypeextension-get?view=graph-rest-1.0)、[更新](/graph/api/opentypeextension-update?view=graph-rest-1.0)或[删除](/graph/api/opentypeextension-delete?view=graph-rest-1.0)扩展及其数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-161">You can subsequently [read](/graph/api/opentypeextension-get?view=graph-rest-1.0), [update](/graph/api/opentypeextension-update?view=graph-rest-1.0), or [delete](/graph/api/opentypeextension-delete?view=graph-rest-1.0) the extension and its data.</span></span>

<span data-ttu-id="eecf3-162">开放扩展示例：[使用开放扩展向用户添加自定义数据](extensibility-open-users.md)</span><span class="sxs-lookup"><span data-stu-id="eecf3-162">Open extension example: [Add custom data to users using open extensions](extensibility-open-users.md)</span></span>

## <a name="schema-extensions"></a><span data-ttu-id="eecf3-163">架构扩展</span><span class="sxs-lookup"><span data-stu-id="eecf3-163">Schema extensions</span></span>


<span data-ttu-id="eecf3-164">通过[架构扩展](/graph/api/resources/schemaextension?view=graph-rest-1.0)，可以定义一个架构，用来扩展资源类型。</span><span class="sxs-lookup"><span data-stu-id="eecf3-164">[Schema extensions](/graph/api/resources/schemaextension?view=graph-rest-1.0) allow you to define a schema that you can use to extend a resource type.</span></span> <span data-ttu-id="eecf3-165">首先，创建架构扩展定义。</span><span class="sxs-lookup"><span data-stu-id="eecf3-165">First, you create your schema extension definition.</span></span> <span data-ttu-id="eecf3-166">然后，利用它通过强类型自定义数据扩展资源实例。</span><span class="sxs-lookup"><span data-stu-id="eecf3-166">Then, use it to extend resource instances with strongly-typed custom data.</span></span> <span data-ttu-id="eecf3-167">此外，还可以控制架构扩展的[状态](#schema-extensions-lifecycle)，让它可被其他应用发现。</span><span class="sxs-lookup"><span data-stu-id="eecf3-167">In addition, you can control the [status](#schema-extensions-lifecycle) of your schema extension and let it be discoverable by other apps.</span></span> <span data-ttu-id="eecf3-168">相应地，这些应用可以对自己的数据使用此扩展，并在它的基础之上生成进一步的体验。</span><span class="sxs-lookup"><span data-stu-id="eecf3-168">These apps can in turn use the extension for their data and build further experiences on top of it.</span></span>


> [!VIDEO https://www.youtube-nocookie.com/embed/3MOAlUFNus0]

<span data-ttu-id="eecf3-169">在创建架构扩展定义时，你必须提供其 **id** 的唯一名称。提供两个命名选项：</span><span class="sxs-lookup"><span data-stu-id="eecf3-169">When creating a schema extension definition, you must provide a unique name for its **id**. There are two naming options:</span></span>

- <span data-ttu-id="eecf3-170">如果已有通过租户验证的 `.com`、`.net`、`.gov`、`.edu` 或 `.org` 域，可以使用域名和架构名称定义唯一名称，格式如下：\{_&#65279;domainName_\}\_\{_&#65279;schemaName_\}。</span><span class="sxs-lookup"><span data-stu-id="eecf3-170">If you already have a vanity `.com`,`.net`, `.gov`, `.edu` or a `.org` domain that you have verified with your tenant, you can use the domain name along with the schema name to define a unique name, in this format \{_&#65279;domainName_\}\_\{_&#65279;schemaName_\}.</span></span> <span data-ttu-id="eecf3-171">例如，如果虚域是 contoso.com，可以定义 `contoso_mySchema` 的 **id**。</span><span class="sxs-lookup"><span data-stu-id="eecf3-171">For example, if your vanity domain is contoso.com, you can define an **id** of, `contoso_mySchema`.</span></span> <span data-ttu-id="eecf3-172">此为首选项。</span><span class="sxs-lookup"><span data-stu-id="eecf3-172">This is the preferred option.</span></span>
- <span data-ttu-id="eecf3-p109">如果没有验证的虚域，则可以只设置架构名称的 **id**（不带域名称前缀），例如，`mySchema`。根据所提供的名称，Microsoft Graph 将为你分配一个字符串 ID，采用以下格式：ext\{_&#65279;8-random-alphanumeric-chars_\}\_\{_&#65279;schema-name_\}。例如，`extkvbmkofy_mySchema`。</span><span class="sxs-lookup"><span data-stu-id="eecf3-p109">If you don’t have a verified vanity domain, you can just set the **id** to a schema name (without a domain name prefix), for example, `mySchema`. Microsoft Graph will assign a string ID for you based on the supplied name, in this format: ext\{_&#65279;8-random-alphanumeric-chars_\}\_\{_&#65279;schema-name_\}.  For example, `extkvbmkofy_mySchema`.</span></span>

<span data-ttu-id="eecf3-176">可以看到，在 **id** 中此唯一名称用作复杂类型名称，复杂类型将在扩展的资源实例上存储自定义数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-176">You will see this unique name in **id** used as the name of the complex type that will store your custom data on the extended resource instance.</span></span>

<span data-ttu-id="eecf3-177">与开放类型不同，管理架构扩展定义（[列出](/graph/api/schemaextension-list?view=graph-rest-1.0)、[创建](/graph/api/schemaextension-post-schemaextensions?view=graph-rest-1.0)、[获取](/graph/api/schemaextension-get?view=graph-rest-1.0)、[更新](/graph/api/schemaextension-update?view=graph-rest-1.0)及[删除](/graph/api/schemaextension-delete?view=graph-rest-1.0)）和管理其数据（添加、获取、更新及删除数据）是独立的 API 操作集。</span><span class="sxs-lookup"><span data-stu-id="eecf3-177">Unlike open extensions, managing schema extension definitions ([list](/graph/api/schemaextension-list?view=graph-rest-1.0), [create](/graph/api/schemaextension-post-schemaextensions?view=graph-rest-1.0), [get](/graph/api/schemaextension-get?view=graph-rest-1.0), [update](/graph/api/schemaextension-update?view=graph-rest-1.0), and [delete](/graph/api/schemaextension-delete?view=graph-rest-1.0)) and managing their data (add, get, update, and delete data) are separate sets of API operations.</span></span>

<span data-ttu-id="eecf3-178">由于架构扩展可以在目标资源实例中作为复杂类型进行访问，因此可以使用下列方法，对架构扩展中的自定义数据执行 CRUD 操作：</span><span class="sxs-lookup"><span data-stu-id="eecf3-178">Because schema extensions are accessible as complex types in instances of the targeted resources, you can do CRUD operations on the custom data in a schema extension in the following ways:</span></span>

- <span data-ttu-id="eecf3-179">资源 `POST` 方法可用于在新建资源实例时指定自定义数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-179">Use the resource `POST` method to specify custom data when creating a new resource instance.</span></span> <span data-ttu-id="eecf3-180">请注意，**contact**、**event**、**message** 和 **post** 资源存在一个[已知问题](known-issues.md#creating-a-resource-instance-and-adding-schema-extension-data-at-the-same-time)，即需要使用 `PATCH` 操作创建架构扩展。</span><span class="sxs-lookup"><span data-stu-id="eecf3-180">Note that there is a [known issue](known-issues.md#creating-a-resource-instance-and-adding-schema-extension-data-at-the-same-time) on the **contact**, **event**, **message**, and **post** resources that requires creating a schema extension using a `PATCH` operation.</span></span>
- <span data-ttu-id="eecf3-181">资源 `GET` 方法可用于读取自定义数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-181">Use the resource `GET` method to read the custom data.</span></span>
- <span data-ttu-id="eecf3-182">使用资源 `PATCH` 方法添加或更新现有资源实例中的自定义数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-182">Use the resource `PATCH` method to add or update custom data in an existing resource instance.</span></span>
- <span data-ttu-id="eecf3-183">使用资源 `PATCH` 方法将复杂类型设置为 NULL，以删除资源实例中的自定义数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-183">Use the resource `PATCH` method to set the complex type to null, to delete the custom data in the resource instance.</span></span>

<span data-ttu-id="eecf3-184">架构扩展示例：[使用架构扩展向组添加自定义数据](extensibility-schema-groups.md)</span><span class="sxs-lookup"><span data-stu-id="eecf3-184">Schema extension example: [Add custom data to groups using schema extensions](extensibility-schema-groups.md)</span></span>

### <a name="schema-extensions-lifecycle"></a><span data-ttu-id="eecf3-185">架构扩展生命周期</span><span class="sxs-lookup"><span data-stu-id="eecf3-185">Schema extensions lifecycle</span></span>

<span data-ttu-id="eecf3-186">当应用创建架构扩展定义时，系统会将该应用标记为该架构扩展的所有者。</span><span class="sxs-lookup"><span data-stu-id="eecf3-186">When your app creates a schema extension definition, the app is marked as the owner of that schema extension.</span></span>

<span data-ttu-id="eecf3-p111">所有者应用可以在**状态**属性上使用 PATCH 操作将扩展转换为生命周期中的不同状态。基于当前状态，所有者应用可以更新或删除扩展。架构扩展的任何更新始终只能累加且不能间断。</span><span class="sxs-lookup"><span data-stu-id="eecf3-p111">The owner app can move the extension through different states of a lifecycle, using a PATCH operation on its **status** property. Depending on the current state, the owner app may be able to update or delete the extension. Any updates to a schema extension should always only be additive and non-breaking.</span></span>

|<span data-ttu-id="eecf3-190">状态</span><span class="sxs-lookup"><span data-stu-id="eecf3-190">State</span></span> |<span data-ttu-id="eecf3-191">生命周期状态行为</span><span class="sxs-lookup"><span data-stu-id="eecf3-191">Lifecycle state behavior</span></span> |
|:-------------|:------------|
| <span data-ttu-id="eecf3-192">InDevelopment</span><span class="sxs-lookup"><span data-stu-id="eecf3-192">InDevelopment</span></span> | <ul><li><span data-ttu-id="eecf3-p112">创建后的初始状态。所有者应用仍然在开发架构扩展。 </span><span class="sxs-lookup"><span data-stu-id="eecf3-p112">Initial state after creation. The owner app is still developing the schema extension. </span></span></li><li><span data-ttu-id="eecf3-195">在此状态下，在所有者应用注册的同一目录中的任何应用程序可以使用此架构定义扩展资源实例（前提是该应用对资源拥有权限）。</span><span class="sxs-lookup"><span data-stu-id="eecf3-195">In this state, any app in the same directory where the owner app is registered can extend resource instances with this schema definition (as long as the app has permissions to that resource).</span></span> </li><li><span data-ttu-id="eecf3-196">仅所有者应用可以使用增量更改来更新扩展定义或将其删除。</span><span class="sxs-lookup"><span data-stu-id="eecf3-196">Only the owner app can update the extension definition with additive changes or delete it.</span></span> </li><li><span data-ttu-id="eecf3-197">所有者应用可以将扩展状态从**开发中**更改为**可用**。</span><span class="sxs-lookup"><span data-stu-id="eecf3-197">The owner app can move the extension from **InDevelopment** to the **Available** state.</span></span></li></ul> |
| <span data-ttu-id="eecf3-198">可用</span><span class="sxs-lookup"><span data-stu-id="eecf3-198">Available</span></span> | <ul><li><span data-ttu-id="eecf3-199">架构扩展可供任意租户中的所有应用使用。</span><span class="sxs-lookup"><span data-stu-id="eecf3-199">The schema extension is available for use by all apps in any tenant.</span></span> </li><li><span data-ttu-id="eecf3-200">所有者应用将扩展设置为“可用”\*\*\*\* 后，任何应用只需将自定义数据添加到扩展中指定的资源类型实例即可（只要应用拥有对相应资源的权限）。</span><span class="sxs-lookup"><span data-stu-id="eecf3-200">After the owner app sets the extension to **Available**, any app can simply add custom data to instances of those resource types specified in the extension (as long as the app has permissions to that resource).</span></span> <span data-ttu-id="eecf3-201">新建实例或更新现有实例时，应用可以分配自定义数据。</span><span class="sxs-lookup"><span data-stu-id="eecf3-201">The app can assign custom data when creating a new instance or updating an existing instance.</span></span> </li><li><span data-ttu-id="eecf3-202">只有所有者应用，才能使用增量更改更新扩展定义。</span><span class="sxs-lookup"><span data-stu-id="eecf3-202">Only the owner app can update the extension definition with additive changes.</span></span> <span data-ttu-id="eecf3-203">任何应用都无法删除这种状态下的扩展定义。</span><span class="sxs-lookup"><span data-stu-id="eecf3-203">No app can delete the extension definition in this state.</span></span> </li><li><span data-ttu-id="eecf3-204">所有者应用可以将架构扩展状态从“可用”\*\*\*\* 更改为“已弃用”\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="eecf3-204">The owner app can move the schema extension from **Available** to the **Deprecated** state.</span></span></li></ul> |
| <span data-ttu-id="eecf3-205">不推荐使用</span><span class="sxs-lookup"><span data-stu-id="eecf3-205">Deprecated</span></span> | <ul><li><span data-ttu-id="eecf3-206">架构扩展定义不再可供读取或修改。</span><span class="sxs-lookup"><span data-stu-id="eecf3-206">The schema extension definition can no longer be read or modified.</span></span> </li><li><span data-ttu-id="eecf3-207">任何应用都无法查看、更新、添加新属性或删除扩展。</span><span class="sxs-lookup"><span data-stu-id="eecf3-207">No app can view, update, add new properties, or delete the extension.</span></span> </li><li><span data-ttu-id="eecf3-208">但是应用仍可读取、更新或删除现有扩展_属性值_。</span><span class="sxs-lookup"><span data-stu-id="eecf3-208">Apps can, however, still read, update, or delete existing extension _property values_.</span></span> </li></ul> |

### <a name="supported-property-data-types"></a><span data-ttu-id="eecf3-209">受支持的属性数据类型</span><span class="sxs-lookup"><span data-stu-id="eecf3-209">Supported property data types</span></span>

<span data-ttu-id="eecf3-210">在架构扩展中定义属性时，支持以下数据类型：</span><span class="sxs-lookup"><span data-stu-id="eecf3-210">The following data types are supported when defining a property in a schema extension:</span></span>

| <span data-ttu-id="eecf3-211">属性类型</span><span class="sxs-lookup"><span data-stu-id="eecf3-211">Property Type</span></span> | <span data-ttu-id="eecf3-212">备注</span><span class="sxs-lookup"><span data-stu-id="eecf3-212">Remarks</span></span> |
|:-------------|:------------|
| <span data-ttu-id="eecf3-213">Binary</span><span class="sxs-lookup"><span data-stu-id="eecf3-213">Binary</span></span> | <span data-ttu-id="eecf3-214">最多 256 字节。</span><span class="sxs-lookup"><span data-stu-id="eecf3-214">256 bytes maximum.</span></span> |
| <span data-ttu-id="eecf3-215">Boolean</span><span class="sxs-lookup"><span data-stu-id="eecf3-215">Boolean</span></span> | <span data-ttu-id="eecf3-216">不支持消息、活动和帖子。</span><span class="sxs-lookup"><span data-stu-id="eecf3-216">Not supported for messages, events and posts.</span></span> |
| <span data-ttu-id="eecf3-217">日期时间</span><span class="sxs-lookup"><span data-stu-id="eecf3-217">DateTime</span></span> | <span data-ttu-id="eecf3-p115">必须以 ISO 8601 格式进行指定。存储为 UTC 格式。</span><span class="sxs-lookup"><span data-stu-id="eecf3-p115">Must be specified in ISO 8601 format. Will be stored in UTC.</span></span> |
| <span data-ttu-id="eecf3-220">整数</span><span class="sxs-lookup"><span data-stu-id="eecf3-220">Integer</span></span> | <span data-ttu-id="eecf3-p116">32 位值。不支持消息、活动和帖子。</span><span class="sxs-lookup"><span data-stu-id="eecf3-p116">32-bit value. Not supported for messages, events and posts.</span></span> |
| <span data-ttu-id="eecf3-223">字符串</span><span class="sxs-lookup"><span data-stu-id="eecf3-223">String</span></span> | <span data-ttu-id="eecf3-224">最多 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="eecf3-224">256 characters maximum.</span></span> |

> <span data-ttu-id="eecf3-225">**注意：** 不支持多值属性。</span><span class="sxs-lookup"><span data-stu-id="eecf3-225">**Note:** Multi-value properties are not supported.</span></span>

### <a name="azure-ad-directory-schema-extensions"></a><span data-ttu-id="eecf3-226">Azure AD 目录架构扩展</span><span class="sxs-lookup"><span data-stu-id="eecf3-226">Azure AD directory schema extensions</span></span>

<span data-ttu-id="eecf3-p117">Azure AD 支持类似的扩展类型，在一些 [directoryObject](/graph/api/resources/directoryobject?view=graph-rest-1.0) 资源中称其为[目录架构扩展](https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-directory-schema-extensions)。虽然必须使用 [Azure AD Graph API](https://msdn.microsoft.com/library/azure/ad/graph/api/api-catalog) 创建并管理目录架构扩展的定义，但是可以使用 Microsoft Graph API 添加、获取、更新和删除这些扩展的属性中的_数据_。</span><span class="sxs-lookup"><span data-stu-id="eecf3-p117">Azure AD supports a similar type of extension, known as [directory schema extensions](https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-directory-schema-extensions), on a few [directoryObject](/graph/api/resources/directoryobject?view=graph-rest-1.0) resources. Although you have to use the [Azure AD Graph API](https://msdn.microsoft.com/library/azure/ad/graph/api/api-catalog) to create and manage the definitions of directory schema extensions, you can use the Microsoft Graph API to add, get, update and delete _data_ in the properties of these extensions.</span></span>

## <a name="permissions"></a><span data-ttu-id="eecf3-229">权限</span><span class="sxs-lookup"><span data-stu-id="eecf3-229">Permissions</span></span>

<span data-ttu-id="eecf3-230">还需要对特定资源执行读取或写入操作所需的相同[权限](./permissions-reference.md)，才能对相应资源上的任意扩展数据执行读取或写入操作。</span><span class="sxs-lookup"><span data-stu-id="eecf3-230">The same [permissions](./permissions-reference.md) that are required to read from or write to a specific resource are also required to read from or write to any extensions data on that resource.</span></span> <span data-ttu-id="eecf3-231">例如，必须向应用授予 *User.ReadWrite.All* 权限，应用才能使用自定义应用数据更新登录用户配置文件。</span><span class="sxs-lookup"><span data-stu-id="eecf3-231">For example, for an app to be able to update the signed-in user's profile with custom app data, the app must have been granted the *User.ReadWrite.All* permission.</span></span>

<span data-ttu-id="eecf3-232">此外，必须向应用授予 *Directory.AccessAsUser.All* 权限，才能创建和管理架构扩展定义。</span><span class="sxs-lookup"><span data-stu-id="eecf3-232">Additionally, to create and manage schema extension definitions, an application must be granted the *Directory.AccessAsUser.All* permission.</span></span>

## <a name="data-limits"></a><span data-ttu-id="eecf3-233">数据限制</span><span class="sxs-lookup"><span data-stu-id="eecf3-233">Data limits</span></span>

### <a name="open-extension-limits"></a><span data-ttu-id="eecf3-234">开放扩展限制</span><span class="sxs-lookup"><span data-stu-id="eecf3-234">Open extension limits</span></span>

<span data-ttu-id="eecf3-235">以下限制适用于目录资源（如 **user**、**group**、**device**）：</span><span class="sxs-lookup"><span data-stu-id="eecf3-235">The following limits apply to directory resources (such as **user**, **group**, **device**):</span></span>

- <span data-ttu-id="eecf3-236">每个开放扩展最多可以包含 2KB 数据（包括扩展定义本身）。</span><span class="sxs-lookup"><span data-stu-id="eecf3-236">Each open extension can have up to 2 KB of data (including the extension definition itself).</span></span>
- <span data-ttu-id="eecf3-237">应用最多可以为每个资源实例添加两个开放扩展。</span><span class="sxs-lookup"><span data-stu-id="eecf3-237">An application can add up to two open extensions per resource instance.</span></span>

<span data-ttu-id="eecf3-238">以下限制将应用于 Outlook 资源（如“**邮件**”、“**事件**”和“**联系人**”）：</span><span class="sxs-lookup"><span data-stu-id="eecf3-238">The following limits apply to Outlook resources (such as **message**, **event**, and **contact**):</span></span>

- <span data-ttu-id="eecf3-239">每个开放扩展存储在 [MAPI 命名的属性](https://msdn.microsoft.com/library/cc765864(v=office.15).aspx)中，这是用户邮箱中的有限资源。</span><span class="sxs-lookup"><span data-stu-id="eecf3-239">Each open extension is stored in a [MAPI named property](https://msdn.microsoft.com/library/cc765864(v=office.15).aspx), which are a limited resource in a user's mailbox.</span></span> <span data-ttu-id="eecf3-240">如需了解更多详情，请参阅 [openTypeExtension 资源类型](/graph/api/resources/opentypeextension?view=graph-rest-1.0)。</span><span class="sxs-lookup"><span data-stu-id="eecf3-240">For more details, see [openTypeExtension resource type](/graph/api/resources/opentypeextension?view=graph-rest-1.0).</span></span>

### <a name="schema-extension-limits"></a><span data-ttu-id="eecf3-241">架构扩展限制</span><span class="sxs-lookup"><span data-stu-id="eecf3-241">Schema extension limits</span></span>

<span data-ttu-id="eecf3-242">应用程序最多可以创建五个**架构扩展**定义。</span><span class="sxs-lookup"><span data-stu-id="eecf3-242">An application may create no more than five **schema extension** definitions.</span></span>

## <a name="known-limitations"></a><span data-ttu-id="eecf3-243">已知限制</span><span class="sxs-lookup"><span data-stu-id="eecf3-243">Known limitations</span></span>

<span data-ttu-id="eecf3-244">有关使用扩展的已知限制，请参阅已知问题文章中的[扩展部分](known-issues.md#extensions)。</span><span class="sxs-lookup"><span data-stu-id="eecf3-244">For known limitations using extensions, see the [extensions section](known-issues.md#extensions) in the known issues article.</span></span>

## <a name="extension-examples"></a><span data-ttu-id="eecf3-245">扩展示例</span><span class="sxs-lookup"><span data-stu-id="eecf3-245">Extension examples</span></span>

- [<span data-ttu-id="eecf3-246">使用开放扩展向用户添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="eecf3-246">Add custom data to users using open extensions</span></span>](extensibility-open-users.md)

- [<span data-ttu-id="eecf3-247">使用架构扩展向组添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="eecf3-247">Add custom data to groups using schema extensions</span></span>](extensibility-schema-groups.md)

## <a name="see-also"></a><span data-ttu-id="eecf3-248">另请参阅</span><span class="sxs-lookup"><span data-stu-id="eecf3-248">See also</span></span>

- [<span data-ttu-id="eecf3-249">Office 365 域</span><span class="sxs-lookup"><span data-stu-id="eecf3-249">Office 365 domains</span></span>](https://technet.microsoft.com/library/office-365-domains.aspx)

- [<span data-ttu-id="eecf3-250">添加并验证 Office 365 租户的域</span><span class="sxs-lookup"><span data-stu-id="eecf3-250">Adding and verifying a domain for an Office 365 tenant</span></span>](https://office365support.ca/adding-and-verifying-a-domain-for-the-new-office-365/)
