# <a name="add-custom-data-to-resources-using-extensions"></a><span data-ttu-id="cce0e-101">使用扩展向资源添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="cce0e-101">Add custom data to resources using extensions</span></span>

<span data-ttu-id="cce0e-p101">Microsoft Graph 提供单一 API 终结点，让你可以通过大量资源（例如[用户](../api-reference/v1.0/resources/user.md)和[邮件](../api-reference/v1.0/resources/message.md)）访问以用户为中心的丰富的数据和见解。现在有一种方法可以让你使用自己的应用程序数据**扩展** Microsoft Graph。无需外部数据存储即可以向 Microsoft Graph 资源添加自定义属性。例如，你可能决定通过扩展**用户**资源来使应用保持在轻量级并将应用特定的用户配置文件数据存储在 Microsoft Graph 中。或者，你可以保留应用的现有用户配置文件存储，并只需向**用户**资源添加特定于应用的存储标识符。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p101">Microsoft Graph provides a single API endpoint that gives you access to rich people-centric data and insights through a number of resources like [user](../api-reference/v1.0/resources/user.md) and [message](../api-reference/v1.0/resources/message.md). There's now a way for you to _**extend**_ Microsoft Graph with your own application data. You can add custom properties to Microsoft Graph resources without requiring an external data store. For example, you might decide to keep your app lightweight and store app-specific user profile data in Microsoft Graph by extending the **user** resource. Alternatively, you might want to retain your app’s existing user profile store, and simply add an app-specific store identifier to the **user** resource.</span></span>

<span data-ttu-id="cce0e-p102">Microsoft Graph 提供两种类型的扩展。选择最适合应用程序需求的扩展类型：</span><span class="sxs-lookup"><span data-stu-id="cce0e-p102">Microsoft Graph offers two types of extensions. Choose the extension type that best suits your application needs:</span></span>

*  <span data-ttu-id="cce0e-109">**开放扩展**：开发人员入门的良好方法。</span><span class="sxs-lookup"><span data-stu-id="cce0e-109">**Open extensions**: A good way for developers to get started.</span></span>
*  <span data-ttu-id="cce0e-110">**架构扩展**：对于那些关心存储类型化数据，使其架构可发现和可共享，能够进行筛选以及将来能够执行输入数据验证和授权的开发人员而言，这是一种更通用的机制。</span><span class="sxs-lookup"><span data-stu-id="cce0e-110">**Schema extensions**: A more versatile mechanism for developers who care about storing typed data, making their schema discoverable and shareable, being able to filter, and in the future, being able to perform input data validation and authorization.</span></span>

><span data-ttu-id="cce0e-111">**重要说明：**不能使用扩展存储敏感的个人身份信息，例如帐户凭据、政府标识号、持卡人数据、财务帐户数据、医疗保健信息或敏感的背景信息。</span><span class="sxs-lookup"><span data-stu-id="cce0e-111">**Important:** You should not use extensions to store sensitive personally identifiable information, such as account credentials, government identification numbers, cardholder data, financial account data, healthcare information, or sensitive background information.</span></span>

## <a name="supported-resources"></a><span data-ttu-id="cce0e-112">支持的资源</span><span class="sxs-lookup"><span data-stu-id="cce0e-112">Supported resources</span></span>

<span data-ttu-id="cce0e-113">下表列出了支持开放扩展和架构扩展的资源，并指明它们是处于通用版本 (GA) 阶段（在 v1.0 和 beta 终结点中均可用），还是处于预览阶段（仅在 beta 终结点中可用）。</span><span class="sxs-lookup"><span data-stu-id="cce0e-113">The following table lists the resources that support open and schema extensions and indicates whether they have reached general availability (GA) (available in both the v1.0 and beta endpoints) or are in preview (available only in the beta endpoint).</span></span>  

| <span data-ttu-id="cce0e-114">资源</span><span class="sxs-lookup"><span data-stu-id="cce0e-114">Resource</span></span> | <span data-ttu-id="cce0e-115">开放扩展</span><span class="sxs-lookup"><span data-stu-id="cce0e-115">Open extensions</span></span> | <span data-ttu-id="cce0e-116">架构扩展</span><span class="sxs-lookup"><span data-stu-id="cce0e-116">Schema extensions</span></span> |
|---------------|-------|-------|
| [<span data-ttu-id="cce0e-117">管理单元</span><span class="sxs-lookup"><span data-stu-id="cce0e-117">Administrative unit</span></span>](../api-reference/beta/resources/administrativeunit.md) | <span data-ttu-id="cce0e-118">仅供预览</span><span class="sxs-lookup"><span data-stu-id="cce0e-118">Preview only</span></span> | <span data-ttu-id="cce0e-119">仅供预览</span><span class="sxs-lookup"><span data-stu-id="cce0e-119">Preview only</span></span> |
|  [<span data-ttu-id="cce0e-120">日历事件</span><span class="sxs-lookup"><span data-stu-id="cce0e-120">Calendar event</span></span>](../api-reference/v1.0/resources/event.md) | <span data-ttu-id="cce0e-121">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-121">GA</span></span> | <span data-ttu-id="cce0e-122">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-122">GA</span></span> |
|  [<span data-ttu-id="cce0e-123">设备</span><span class="sxs-lookup"><span data-stu-id="cce0e-123">Device</span></span>](../api-reference/v1.0/resources/device.md) | <span data-ttu-id="cce0e-124">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-124">GA</span></span> | <span data-ttu-id="cce0e-125">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-125">GA</span></span> |
|  [<span data-ttu-id="cce0e-126">组</span><span class="sxs-lookup"><span data-stu-id="cce0e-126">Group</span></span>](../api-reference/v1.0/resources/group.md) | <span data-ttu-id="cce0e-127">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-127">GA</span></span> | <span data-ttu-id="cce0e-128">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-128">GA</span></span> |
|  [<span data-ttu-id="cce0e-129">组日历事件</span><span class="sxs-lookup"><span data-stu-id="cce0e-129">Group calendar event</span></span>](../api-reference/v1.0/resources/event.md) | <span data-ttu-id="cce0e-130">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-130">GA</span></span> | <span data-ttu-id="cce0e-131">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-131">GA</span></span> |
|  [<span data-ttu-id="cce0e-132">组对话帖子</span><span class="sxs-lookup"><span data-stu-id="cce0e-132">Group conversation post</span></span>](../api-reference/v1.0/resources/post.md) | <span data-ttu-id="cce0e-133">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-133">GA</span></span> | <span data-ttu-id="cce0e-134">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-134">GA</span></span> |
|  [<span data-ttu-id="cce0e-135">邮件</span><span class="sxs-lookup"><span data-stu-id="cce0e-135">Message</span></span>](../api-reference/v1.0/resources/message.md) | <span data-ttu-id="cce0e-136">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-136">GA</span></span> | <span data-ttu-id="cce0e-137">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-137">GA</span></span> |
|  [<span data-ttu-id="cce0e-138">组织</span><span class="sxs-lookup"><span data-stu-id="cce0e-138">Organization</span></span>](../api-reference/v1.0/resources/organization.md) | <span data-ttu-id="cce0e-139">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-139">GA</span></span> | <span data-ttu-id="cce0e-140">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-140">GA</span></span> |
|  [<span data-ttu-id="cce0e-141">个人联系人</span><span class="sxs-lookup"><span data-stu-id="cce0e-141">Personal contact</span></span>](../api-reference/v1.0/resources/contact.md)| <span data-ttu-id="cce0e-142">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-142">GA</span></span> | <span data-ttu-id="cce0e-143">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-143">GA</span></span> |
|  [<span data-ttu-id="cce0e-144">用户</span><span class="sxs-lookup"><span data-stu-id="cce0e-144">User</span></span>](../api-reference/v1.0/resources/user.md) | <span data-ttu-id="cce0e-145">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-145">GA</span></span> | <span data-ttu-id="cce0e-146">GA</span><span class="sxs-lookup"><span data-stu-id="cce0e-146">GA</span></span> |

<span data-ttu-id="cce0e-p103">使用工作帐户或学校帐户登录时，可以对所有这些资源使用扩展。此外，使用个人帐户登录时，可以对这些资源使用扩展 - **事件**、**帖子**、**组**、**邮件**、**联系人**和**用户**。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p103">You can use extensions on all these resources when signed-in with a work or school account. In addition, you can use extensions on these resources - **event**, **post**, **group**, **message**, **contact**, and **user** - when signed-in with a personal account.</span></span> 

## <a name="open-extensions"></a><span data-ttu-id="cce0e-149">开放扩展</span><span class="sxs-lookup"><span data-stu-id="cce0e-149">Open extensions</span></span>

<span data-ttu-id="cce0e-150">[开放扩展](../api-reference/v1.0/resources/opentypeextension.md)（以前称为 Office 365 数据扩展）是提供灵活方法将非类型化应用数据直接添加到资源实例的[开放类型](http://www.odata.org/getting-started/advanced-tutorial/#openType)。</span><span class="sxs-lookup"><span data-stu-id="cce0e-150">[Open extensions](../api-reference/v1.0/resources/opentypeextension.md) (formerly known as Office 365 data extensions) are [open types](http://www.odata.org/getting-started/advanced-tutorial/#openType) that offer a flexible way to add untyped app data directly to a resource instance.</span></span> 

<span data-ttu-id="cce0e-p104">开放扩展及其自定义数据可通过资源实例的 **扩展**导航属性访问。**extensionName** 属性是开放扩展中唯一的预定义可写属性。创建开放扩展时，必须为 **extensionName** 属性分配一个在租户内是唯一的名称。实现此目的的一种方法是使用反向域名名称系统 (DNS) 格式，该格式取决于你拥有的域，例如 `Com.Contoso.ContactInfo`。请勿在扩展名中使用 Microsoft 域（`Com.Microsoft` 或 `Com.OnMicrosoft`）。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p104">Open extensions, together with their custom data, are accessible through the **extensions** navigation property of the resource instance. The **extensionName** property is the only _pre-defined_, writable property in an open extension. When creating an open extension, you must assign the **extensionName** property a name that is unique within the tenant. One way to do this is to use a reverse domain name system (DNS) format that is dependent on _your own domain_, for example, `Com.Contoso.ContactInfo`. Do not use the Microsoft domain (`Com.Microsoft` or `Com.OnMicrosoft`) in an extension name.</span></span>

<span data-ttu-id="cce0e-p105">只需使用同一个操作即可在资源实例中[创建开放扩展](../api-reference/v1.0/api/opentypeextension_post_opentypeextension.md)并将自定义数据存储到其中（请注意[下面的已知限制](known_issues.md#extensions)，了解受支持的部分资源）。随后可以[读取](../api-reference/v1.0/api/opentypeextension_get.md)、[更新](../api-reference/v1.0/api/opentypeextension_update.md)或[删除](../api-reference/v1.0/api/opentypeextension_delete.md)扩展及其数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p105">You can [create an open extension](../api-reference/v1.0/api/opentypeextension_post_opentypeextension.md) in a resource instance and store custom data to it all in the same operation (note [known limitation below](known_issues.md#extensions) for some of the supported resources). You can subsequently [read](../api-reference/v1.0/api/opentypeextension_get.md), [update](../api-reference/v1.0/api/opentypeextension_update.md), or [delete](../api-reference/v1.0/api/opentypeextension_delete.md) the extension and its data.</span></span>

<span data-ttu-id="cce0e-158">开放扩展示例：[使用开放扩展向用户添加自定义数据](extensibility_open_users.md)</span><span class="sxs-lookup"><span data-stu-id="cce0e-158">Open extension example: [Add custom data to users using open extensions](extensibility_open_users.md)</span></span>

## <a name="schema-extensions"></a><span data-ttu-id="cce0e-159">架构扩展</span><span class="sxs-lookup"><span data-stu-id="cce0e-159">Schema extensions</span></span>

<span data-ttu-id="cce0e-p106">通过[架构扩展](../api-reference/v1.0/resources/schemaextension.md)可以定义一个架构并使用它来扩展资源类型。首先创建架构扩展定义。然后，利用它通过强类型自定义数据扩展资源实例。此外，可以控制架构扩展的[状态](#schema-extensions-lifecycle)并使其可被其他应用发现。反之，这些应用可以将此扩展用于他们的数据，并在此基础上生成进一步的体验。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p106">[Schema extensions](../api-reference/v1.0/resources/schemaextension.md) allow you to define a schema you can use to extend a resource type. First, you create your schema extension definition. Then, use it to extend resource instances with strongly-typed custom data. In addition, you can control the [status](#schema-extensions-lifecycle) of your schema extension and let it be discoverable by other apps. These apps can in turn use the extension for their data and build further experiences on top of it.</span></span>

<span data-ttu-id="cce0e-165">在创建架构扩展定义时，你必须提供其 **id** 的唯一名称。有两个命名选项：</span><span class="sxs-lookup"><span data-stu-id="cce0e-165">When creating a schema extension definition, you must provide a unique name for its **id**. There are two naming options:</span></span>

- <span data-ttu-id="cce0e-166">如果已经有通过租户验证的 `.com`、`.net`、`.gov`、`.edu` 或 `.org` 虚域，则可以使用域名和架构名称来定义一个唯一名称，采用以下格式： \{_&#65279;domainName_\}\_\{_&#65279;schemaName_\}。</span><span class="sxs-lookup"><span data-stu-id="cce0e-166">If you already have a vanity  domain that you have verified with your tenant, you can use the domain name along with the schema name to define a unique name, in this format  &#65279;domainName    &#65279;schemaName . For example, if your vanity domain is contoso.com then you can define an id of, .  This is the preferred option.</span></span> <span data-ttu-id="cce0e-167">例如，如果虚域是 contoso.com，则可以定义 `contoso_mySchema` 的 **id**。</span><span class="sxs-lookup"><span data-stu-id="cce0e-167">For example, if your vanity domain is contoso.com then you can define an **id** of, `contoso_mySchema`.</span></span>  <span data-ttu-id="cce0e-168">这是首选选项。</span><span class="sxs-lookup"><span data-stu-id="cce0e-168">This is the preferred option.</span></span>
- <span data-ttu-id="cce0e-p108">如果没有验证的虚域，则可以只设置架构名称的 **id**（不带域名称前缀），例如，`mySchema`。根据所提供的名称，Microsoft Graph 将为你分配一个字符串 ID，采用以下格式：ext\{_&#65279;8-random-alphanumeric-chars_\}\_\{_&#65279;schema-name_\}。例如，`extkvbmkofy_mySchema`。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p108">If you don’t have a verified vanity domain, you can just set the **id** to a schema name (without a domain name prefix), for example, `mySchema`. Microsoft Graph will assign a string ID for you based on the supplied name, in this format: ext\{_&#65279;8-random-alphanumeric-chars_\}\_\{_&#65279;schema-name_\}.  For example, `extkvbmkofy_mySchema`.</span></span>

<span data-ttu-id="cce0e-172">将在 **id** 中看到用作复杂类型名称的此唯一名称，该复杂类型将在扩展的资源实例上存储自定义数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-172">You will see this unique name in **id** used as the name of the complex type which will store your custom data on the extended resource instance.</span></span>

<span data-ttu-id="cce0e-173">与开放类型不同，管理架构扩展定义（[列出](../api-reference/v1.0/api/schemaextension_list.md)、[创建](../api-reference/v1.0/api/schemaextension_post_schemaextensions.md)、[获取](../api-reference/v1.0/api/schemaextension_get.md)、[更新](../api-reference/v1.0/api/schemaextension_update.md)及[删除](../api-reference/v1.0/api/schemaextension_delete.md)）和管理其数据（添加、获取、更新及删除数据）是独立的 API 操作集。</span><span class="sxs-lookup"><span data-stu-id="cce0e-173">Unlike open extensions, managing schema extension definitions ([list](../api-reference/v1.0/api/schemaextension_list.md), [create](../api-reference/v1.0/api/schemaextension_post_schemaextensions.md), [get](../api-reference/v1.0/api/schemaextension_get.md), [update](../api-reference/v1.0/api/schemaextension_update.md), and [delete](../api-reference/v1.0/api/schemaextension_delete.md)) and managing their data (add, get, update, and delete data) are separate sets of API operations.</span></span> 

<span data-ttu-id="cce0e-174">由于架构扩展可作为复杂类型在目标资源的实例中访问，因此可以使用以下方法对架构扩展中的自定义数据执行 CRUD 操作：</span><span class="sxs-lookup"><span data-stu-id="cce0e-174">Since schema extensions are accessible as complex types in instances of the targeted resources, you can do CRUD operations on the custom data in a schema extension in the following ways:</span></span>

- <span data-ttu-id="cce0e-175">创建新的资源实例时，使用资源 `POST` 方法指定自定义数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-175">Use the resource `POST` method to specify custom data when creating a new resource instance.</span></span>
- <span data-ttu-id="cce0e-176">使用资源 `GET` 方法读取自定义数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-176">Use the resource `GET` method to read the custom data.</span></span>
- <span data-ttu-id="cce0e-177">使用资源 `PATCH` 方法添加或更新现有资源实例中的自定义数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-177">Use the resource `PATCH` method to add or update custom data in an existing resource instance.</span></span>
- <span data-ttu-id="cce0e-178">使用资源 `PATCH` 方法将复杂类型设置为 NULL，以删除资源实例中的自定义数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-178">Use the resource `PATCH` method to set the complex type to null, to delete the custom data in the resource instance.</span></span> 

<span data-ttu-id="cce0e-179">架构扩展示例：[使用架构扩展向组添加自定义数据](extensibility_schema_groups.md)</span><span class="sxs-lookup"><span data-stu-id="cce0e-179">Schema extension example: [Add custom data to groups using schema extensions](extensibility_schema_groups.md)</span></span>


### <a name="schema-extensions-lifecycle"></a><span data-ttu-id="cce0e-180">架构扩展生命周期</span><span class="sxs-lookup"><span data-stu-id="cce0e-180">Schema extensions lifecycle</span></span>

<span data-ttu-id="cce0e-181">当应用创建架构扩展定义时，系统会将该应用标记为该架构扩展的所有者。</span><span class="sxs-lookup"><span data-stu-id="cce0e-181">When your app creates a schema extension definition, the app is marked as the owner of that schema extension.</span></span> 

<span data-ttu-id="cce0e-p109">所有者应用可以在**状态**属性上使用 PATCH 操作将扩展转换为生命周期中的不同状态。基于当前状态，所有者应用可以更新或删除扩展。架构扩展的任何更新始终只能累加且不能间断。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p109">The owner app can move the extension through different states of a lifecycle, using a PATCH operation on its **status** property. Depending on the current state, the owner app may be able to update or delete the extension. Any updates to a schema extension should always only be additive and non-breaking.</span></span>


| <span data-ttu-id="cce0e-185">状态</span><span class="sxs-lookup"><span data-stu-id="cce0e-185">State</span></span> | <span data-ttu-id="cce0e-186">生命周期状态行为</span><span class="sxs-lookup"><span data-stu-id="cce0e-186">Lifecycle state behavior</span></span> |
|-------------|------------|
| <span data-ttu-id="cce0e-187">InDevelopment</span><span class="sxs-lookup"><span data-stu-id="cce0e-187">InDevelopment</span></span> | <ul><li><span data-ttu-id="cce0e-p110">创建后的初始状态。所有者应用仍然在开发架构扩展。 </span><span class="sxs-lookup"><span data-stu-id="cce0e-p110">Initial state after creation. The owner app is still developing the schema extension. </span></span></li><li><span data-ttu-id="cce0e-190">在此状态下，只有所有者应用可以使用此架构定义扩展资源实例，并且只能在注册所有者应用的同一目录进行。</span><span class="sxs-lookup"><span data-stu-id="cce0e-190">In this state, only the owner app can extend resource instances with this schema definition, and only in the same directory where the owner app is registered.</span></span> </li><li><span data-ttu-id="cce0e-191">仅所有者应用可以使用增量更改来更新扩展定义或将其删除。</span><span class="sxs-lookup"><span data-stu-id="cce0e-191">Only the owner app can update the extension definition with additive changes or delete it.</span></span> </li><li><span data-ttu-id="cce0e-192">所有者应用可以将扩展状态从**开发中**更改为**可用**。</span><span class="sxs-lookup"><span data-stu-id="cce0e-192">The owner app can move the extension from **InDevelopment** to the **Available** state.</span></span></li></ul> |
| <span data-ttu-id="cce0e-193">可用</span><span class="sxs-lookup"><span data-stu-id="cce0e-193">Available</span></span> | <ul><li><span data-ttu-id="cce0e-194">架构扩展可供任意租户中的所有应用使用。</span><span class="sxs-lookup"><span data-stu-id="cce0e-194">The schema extension is available for use by all apps in any tenant.</span></span> </li><li><span data-ttu-id="cce0e-p111">所有者应用将扩展设置为**可用**后，任何应用都只需将自定义数据添加到扩展中指定的资源类型的实例中（只要该应用具有该资源的相应权限）。创建新实例或更新现有实例时该应用可以分配自定义数据。 </span><span class="sxs-lookup"><span data-stu-id="cce0e-p111">Once the owner app sets the extension to **Available**, any app can simply add custom data to instances of those resource types specified in the extension (as long as the app has permissions to that resource). The app can assign custom data when creating a new instance, or updating an existing instance. </span></span></li><li><span data-ttu-id="cce0e-197">仅所有者应用可以使用增量更改来更新扩展定义。</span><span class="sxs-lookup"><span data-stu-id="cce0e-197">Only the owner app can update the extension definition with additive changes.</span></span> <br><span data-ttu-id="cce0e-198">- 在此状态下，任何应用都无法删除扩展定义。</span><span class="sxs-lookup"><span data-stu-id="cce0e-198">- No app can delete the extension definition in this state.</span></span> </li><li><span data-ttu-id="cce0e-199">所有者应用可以将架构扩展状态从**可用**更改为**不推荐使用**。</span><span class="sxs-lookup"><span data-stu-id="cce0e-199">The owner app can move the schema extension from **Available** to the **Deprecated** state.</span></span></li></ul> |
| <span data-ttu-id="cce0e-200">不推荐使用</span><span class="sxs-lookup"><span data-stu-id="cce0e-200">Deprecated</span></span> | <ul><li><span data-ttu-id="cce0e-201">架构扩展定义不再可供读取或修改。</span><span class="sxs-lookup"><span data-stu-id="cce0e-201">The schema extension definition can no longer be read or modified.</span></span> </li><li><span data-ttu-id="cce0e-202">任何应用都无法查看、更新、添加新属性或删除扩展。</span><span class="sxs-lookup"><span data-stu-id="cce0e-202">No app can view, update, add new properties, or delete the extension.</span></span> </li><li><span data-ttu-id="cce0e-203">但是应用仍可读取、更新或删除现有扩展_属性值_。</span><span class="sxs-lookup"><span data-stu-id="cce0e-203">Apps can, however, still read, update, or delete existing extension _property values_.</span></span> </li><li><span data-ttu-id="cce0e-204">所有者应用可以将架构扩展从状态**不推荐使用**更改回**可用**。</span><span class="sxs-lookup"><span data-stu-id="cce0e-204">The owner app can move the schema extension from **Deprecated** back to the **Available** state.</span></span></li></ul> |

### <a name="supported-property-data-types"></a><span data-ttu-id="cce0e-205">受支持的属性数据类型</span><span class="sxs-lookup"><span data-stu-id="cce0e-205">Supported property data types</span></span>

<span data-ttu-id="cce0e-206">在架构扩展中定义属性时，支持以下数据类型：</span><span class="sxs-lookup"><span data-stu-id="cce0e-206">The following data types are supported when defining a property in a schema extension:</span></span>

| <span data-ttu-id="cce0e-207">属性类型</span><span class="sxs-lookup"><span data-stu-id="cce0e-207">Property Type</span></span> | <span data-ttu-id="cce0e-208">备注</span><span class="sxs-lookup"><span data-stu-id="cce0e-208">Remarks</span></span> |
|-------------|------------|
| <span data-ttu-id="cce0e-209">Binary</span><span class="sxs-lookup"><span data-stu-id="cce0e-209">Binary</span></span> | <span data-ttu-id="cce0e-210">最多 256 字节。</span><span class="sxs-lookup"><span data-stu-id="cce0e-210">256 bytes maximum.</span></span> |
| <span data-ttu-id="cce0e-211">Boolean</span><span class="sxs-lookup"><span data-stu-id="cce0e-211">Boolean</span></span> | <span data-ttu-id="cce0e-212">不支持消息、活动和帖子。</span><span class="sxs-lookup"><span data-stu-id="cce0e-212">Not supported for messages, events and posts.</span></span> |
| <span data-ttu-id="cce0e-213">日期时间</span><span class="sxs-lookup"><span data-stu-id="cce0e-213">DateTime</span></span> | <span data-ttu-id="cce0e-p112">必须以 ISO 8601 格式进行指定。存储为 UTC 格式。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p112">Must be specified in ISO 8601 format. Will be stored in UTC.</span></span> |
| <span data-ttu-id="cce0e-216">整数</span><span class="sxs-lookup"><span data-stu-id="cce0e-216">Integer</span></span> | <span data-ttu-id="cce0e-p113">32 位值。不支持消息、活动和帖子。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p113">32-bit value. Not supported for messages, events and posts.</span></span> |
| <span data-ttu-id="cce0e-219">字符串</span><span class="sxs-lookup"><span data-stu-id="cce0e-219">String</span></span> | <span data-ttu-id="cce0e-220">最多 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="cce0e-220">256 characters maximum.</span></span> |

><span data-ttu-id="cce0e-221">**注意：**不支持多值属性。</span><span class="sxs-lookup"><span data-stu-id="cce0e-221">**Note:** Multi-value properties are not supported.</span></span>

### <a name="azure-ad-directory-schema-extensions"></a><span data-ttu-id="cce0e-222">Azure AD 目录架构扩展</span><span class="sxs-lookup"><span data-stu-id="cce0e-222">Azure AD directory schema extensions</span></span>

<span data-ttu-id="cce0e-p114">Azure AD 支持类似的扩展类型，在一些 [directoryObject](../api-reference/v1.0/resources/directoryObject.md) 资源中称其为[目录架构扩展](https://msdn.microsoft.com/en-us/library/azure/ad/graph/howto/azure-ad-graph-api-directory-schema-extensions)。虽然必须使用 Azure AD Graph API 创建并管理目录架构扩展的定义，但是可以使用 Microsoft Graph API 添加、获取、更新和删除这些扩展的属性中的数据。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p114">Azure AD supports a similar type of extensions, known as [directory schema extensions](https://msdn.microsoft.com/en-us/library/azure/ad/graph/howto/azure-ad-graph-api-directory-schema-extensions), on a few [directoryObject](../api-reference/v1.0/resources/directoryObject.md) resources. While you must use Azure AD Graph API to create and manage the definitions of directory schema extensions, you can use Microsoft Graph API to add, get, update and delete _data_ in the properties of these extensions.</span></span>

## <a name="permissions"></a><span data-ttu-id="cce0e-225">权限</span><span class="sxs-lookup"><span data-stu-id="cce0e-225">Permissions</span></span>

<span data-ttu-id="cce0e-p115">还需要对特定资源执行读取或写入操作所需的相同[权限](./permissions_reference.md)，以便对该资源上的任意扩展数据执行读取或写入操作。例如，对于能够使用自定义应用数据更新登录用户的个人资料的应用，必须向该应用授予 * User.ReadWrite.All * 权限。</span><span class="sxs-lookup"><span data-stu-id="cce0e-p115">The same [permissions](./permissions_reference.md) that are required to read from or write to a specific resource are also required to read from or write to any extensions data on that resource.  For example, for an app to be able to update the signed-in user's profile with custom app data, the app must have been granted the *User.ReadWrite.All* permission.</span></span>

<span data-ttu-id="cce0e-228">此外，要创建和管理架构扩展定义，必须向应用程序授予 *Directory.AccessAsUser.All* 权限。</span><span class="sxs-lookup"><span data-stu-id="cce0e-228">Additionally, to create and manage schema extension definitions, an application must be granted the *Directory.AccessAsUser.All* permission.</span></span>

## <a name="data-limits"></a><span data-ttu-id="cce0e-229">数据限制</span><span class="sxs-lookup"><span data-stu-id="cce0e-229">Data limits</span></span>

### <a name="open-extension-limits"></a><span data-ttu-id="cce0e-230">开放扩展限制</span><span class="sxs-lookup"><span data-stu-id="cce0e-230">Open extension limits</span></span>
<span data-ttu-id="cce0e-231">以下限制适用于目录资源（如**用户**、**组**、**设备**）：</span><span class="sxs-lookup"><span data-stu-id="cce0e-231">The following limits apply to directory resources (such as **user**, **group**, **device**):</span></span>

- <span data-ttu-id="cce0e-232">每个开放扩展最多可以包含 2KB 的数据（包括扩展定义本身）。</span><span class="sxs-lookup"><span data-stu-id="cce0e-232">Each open extension can have up to 2KB of data (including the extension definition itself).</span></span>
- <span data-ttu-id="cce0e-233">应用程序最多可为每个资源实例添加两个开放扩展。</span><span class="sxs-lookup"><span data-stu-id="cce0e-233">An application can add up to two open extensions per resource instance.</span></span>

### <a name="schema-extension-limits"></a><span data-ttu-id="cce0e-234">架构扩展限制</span><span class="sxs-lookup"><span data-stu-id="cce0e-234">Schema extension limits</span></span>
<span data-ttu-id="cce0e-235">应用程序最多可以创建五个**架构扩展**定义。</span><span class="sxs-lookup"><span data-stu-id="cce0e-235">An application may create no more than five **schema extension** definitions.</span></span>

## <a name="known-limitations"></a><span data-ttu-id="cce0e-236">已知限制</span><span class="sxs-lookup"><span data-stu-id="cce0e-236">Known limitations</span></span>

<span data-ttu-id="cce0e-237">有关使用扩展的已知限制，请参阅已知问题文章中的[扩展部分](known_issues.md#extensions)。</span><span class="sxs-lookup"><span data-stu-id="cce0e-237">For known limitations using extensions, see the [extensions section](known_issues.md#extensions) in the known issues article.</span></span>

## <a name="extension-examples"></a><span data-ttu-id="cce0e-238">扩展示例</span><span class="sxs-lookup"><span data-stu-id="cce0e-238">Extension examples</span></span>

[<span data-ttu-id="cce0e-239">使用开放扩展向用户添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="cce0e-239">Add custom data to users using open extensions</span></span>](extensibility_open_users.md)

[<span data-ttu-id="cce0e-240">使用架构扩展向组添加自定义数据</span><span class="sxs-lookup"><span data-stu-id="cce0e-240">Add custom data to groups using schema extensions</span></span>](extensibility_schema_groups.md)

## <a name="see-also"></a><span data-ttu-id="cce0e-241">另请参阅</span><span class="sxs-lookup"><span data-stu-id="cce0e-241">See also</span></span>

[<span data-ttu-id="cce0e-242">Office 365 域</span><span class="sxs-lookup"><span data-stu-id="cce0e-242">Office 365 domains</span></span>](https://technet.microsoft.com/en-us/library/office-365-domains.aspx)

[<span data-ttu-id="cce0e-243">添加并验证 Office 365 租户的域</span><span class="sxs-lookup"><span data-stu-id="cce0e-243">Adding and verifying a domain for an Office 365 tenant</span></span>](http://office365support.ca/adding-and-verifying-a-domain-for-the-new-office-365/)
