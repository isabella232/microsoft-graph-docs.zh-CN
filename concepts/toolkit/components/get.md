---
title: 获取 Microsoft Graph 工具包中的组件
description: 通过获取组件，可以在 HTML 中直接在 Microsoft Graph 中进行任何 GET 查询。
localization_priority: Normal
author: nmetulev
ms.openlocfilehash: b9dcbd5af4c9938dce821c30021a4cf3439fd1b2
ms.sourcegitcommit: 1bc5a0c179dce57e90349610566fb86e1b5fbf95
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/04/2020
ms.locfileid: "43144315"
---
# <a name="get-component-in-the-microsoft-graph-toolkit"></a><span data-ttu-id="8a361-103">获取 Microsoft Graph 工具包中的组件</span><span class="sxs-lookup"><span data-stu-id="8a361-103">Get component in the Microsoft Graph Toolkit</span></span>

<span data-ttu-id="8a361-104">您可以使用`mgt-get`从 Microsoft Graph 直接在 HTML 中进行任何 GET 查询。</span><span class="sxs-lookup"><span data-stu-id="8a361-104">You can use `mgt-get` to make any GET query from Microsoft Graph directly in your HTML.</span></span> <span data-ttu-id="8a361-105">组件不提供默认 UI，需要您编写模板。</span><span class="sxs-lookup"><span data-stu-id="8a361-105">The component does not provide a default UI and requires that you write a template.</span></span>

## <a name="example"></a><span data-ttu-id="8a361-106">示例</span><span class="sxs-lookup"><span data-stu-id="8a361-106">Example</span></span>

<span data-ttu-id="8a361-107">下面的示例演示如何使用`mgt-get`组件来显示用户的电子邮件。</span><span class="sxs-lookup"><span data-stu-id="8a361-107">The following example shows the use of the `mgt-get` component to display a user's emails.</span></span> <span data-ttu-id="8a361-108">您可以使用代码编辑器来查看[属性和属性](#properties-and-attributes)如何更改组件的行为。</span><span class="sxs-lookup"><span data-stu-id="8a361-108">You can use the code editor to see how [properties and attributes](#properties-and-attributes) change the behavior of the component.</span></span>

<iframe src="https://mgt.dev/iframe.html?id=components-mgt-get--get-email&source=docs" height="500"></iframe>

[<span data-ttu-id="8a361-109">在 "dev" 中打开此示例</span><span class="sxs-lookup"><span data-stu-id="8a361-109">Open this example in mgt.dev</span></span>](https://mgt.dev/?path=/story/components-mgt-get--get-email&source=docs)

## <a name="properties-and-attributes"></a><span data-ttu-id="8a361-110">属性和属性</span><span class="sxs-lookup"><span data-stu-id="8a361-110">Properties and attributes</span></span>

<span data-ttu-id="8a361-111">您可以使用多个属性来更改组件的行为。</span><span class="sxs-lookup"><span data-stu-id="8a361-111">You can use several attributes to change the behavior of the component.</span></span> <span data-ttu-id="8a361-112">唯一的必需属性是`resource`。</span><span class="sxs-lookup"><span data-stu-id="8a361-112">The only required attribute is `resource`.</span></span>

| <span data-ttu-id="8a361-113">属性</span><span class="sxs-lookup"><span data-stu-id="8a361-113">Attribute</span></span> | <span data-ttu-id="8a361-114">属性</span><span class="sxs-lookup"><span data-stu-id="8a361-114">Property</span></span>  | <span data-ttu-id="8a361-115">说明</span><span class="sxs-lookup"><span data-stu-id="8a361-115">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8a361-116">资源</span><span class="sxs-lookup"><span data-stu-id="8a361-116">resource</span></span> | <span data-ttu-id="8a361-117">resource</span><span class="sxs-lookup"><span data-stu-id="8a361-117">resource</span></span> | <span data-ttu-id="8a361-118">要从 Microsoft Graph 中获取的资源（例如， `/me`）。</span><span class="sxs-lookup"><span data-stu-id="8a361-118">The resource to get from Microsoft Graph (for example, `/me`).</span></span> |
| <span data-ttu-id="8a361-119">scopes</span><span class="sxs-lookup"><span data-stu-id="8a361-119">scopes</span></span> | <span data-ttu-id="8a361-120">scopes</span><span class="sxs-lookup"><span data-stu-id="8a361-120">scopes</span></span> | <span data-ttu-id="8a361-121">如果使用属性或以逗号分隔的范围（如果使用属性），则为可选的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="8a361-121">Optional array of strings if using the property or a comma delimited scope if using the attribute.</span></span> <span data-ttu-id="8a361-122">组件将使用这些作用域（使用受支持的提供程序），以确保用户已同意正确的权限。</span><span class="sxs-lookup"><span data-stu-id="8a361-122">The component will use these scopes (with a supported provider) to ensure that the user has consented to the right permission.</span></span> |
| <span data-ttu-id="8a361-123">version</span><span class="sxs-lookup"><span data-stu-id="8a361-123">version</span></span> | <span data-ttu-id="8a361-124">version</span><span class="sxs-lookup"><span data-stu-id="8a361-124">version</span></span> | <span data-ttu-id="8a361-125">在发出 GET 请求时要使用的可选 API 版本。</span><span class="sxs-lookup"><span data-stu-id="8a361-125">Optional API version to use when making the GET request.</span></span> <span data-ttu-id="8a361-126">默认值为 `v1.0`。</span><span class="sxs-lookup"><span data-stu-id="8a361-126">Default is `v1.0`.</span></span>  |
| <span data-ttu-id="8a361-127">最大页数</span><span class="sxs-lookup"><span data-stu-id="8a361-127">max-pages</span></span> | <span data-ttu-id="8a361-128">maxPages</span><span class="sxs-lookup"><span data-stu-id="8a361-128">maxPages</span></span> | <span data-ttu-id="8a361-129">可选页数（针对支持分页的资源）。</span><span class="sxs-lookup"><span data-stu-id="8a361-129">Optional number of pages (for resources that support paging).</span></span> <span data-ttu-id="8a361-130">默认值为3。</span><span class="sxs-lookup"><span data-stu-id="8a361-130">Default is 3.</span></span> <span data-ttu-id="8a361-131">将此值设置为0将获取所有页面。</span><span class="sxs-lookup"><span data-stu-id="8a361-131">Setting this value to 0 will get all pages.</span></span>  |
| <span data-ttu-id="8a361-132">轮询率</span><span class="sxs-lookup"><span data-stu-id="8a361-132">polling-rate</span></span> | <span data-ttu-id="8a361-133">pollingRate</span><span class="sxs-lookup"><span data-stu-id="8a361-133">pollingRate</span></span> | <span data-ttu-id="8a361-134">可选的 miliseconds 数量。</span><span class="sxs-lookup"><span data-stu-id="8a361-134">Optional number of miliseconds.</span></span> <span data-ttu-id="8a361-135">设置后，组件将按照定义的时间间隔轮询更新的请求 URI。</span><span class="sxs-lookup"><span data-stu-id="8a361-135">When set, the component will poll the request URI for updates in the defined interval.</span></span> <span data-ttu-id="8a361-136">如果使用 delta 查询，轮询将始终查询 delta API。</span><span class="sxs-lookup"><span data-stu-id="8a361-136">If using a delta query, polling will always query the delta API.</span></span> <span data-ttu-id="8a361-137">模板仅在数据更改时才会刷新。</span><span class="sxs-lookup"><span data-stu-id="8a361-137">The template will only refresh when the data changes.</span></span> |
| <span data-ttu-id="8a361-138">不适用</span><span class="sxs-lookup"><span data-stu-id="8a361-138">N/A</span></span> | <span data-ttu-id="8a361-139">响应</span><span class="sxs-lookup"><span data-stu-id="8a361-139">response</span></span> | <span data-ttu-id="8a361-140">如果请求成功，则为来自 Microsoft Graph 的只读响应。</span><span class="sxs-lookup"><span data-stu-id="8a361-140">Read-only response from Microsoft Graph if request was successful.</span></span>  |
| <span data-ttu-id="8a361-141">不适用</span><span class="sxs-lookup"><span data-stu-id="8a361-141">N/A</span></span> |<span data-ttu-id="8a361-142">error</span><span class="sxs-lookup"><span data-stu-id="8a361-142">error</span></span>| <span data-ttu-id="8a361-143">如果请求不成功，则为 Microsoft Graph 中的只读错误。</span><span class="sxs-lookup"><span data-stu-id="8a361-143">Read-only error from Microsoft Graph if request was not successful.</span></span> |

## <a name="methods"></a><span data-ttu-id="8a361-144">方法</span><span class="sxs-lookup"><span data-stu-id="8a361-144">Methods</span></span>
| <span data-ttu-id="8a361-145">方法</span><span class="sxs-lookup"><span data-stu-id="8a361-145">Method</span></span> | <span data-ttu-id="8a361-146">说明</span><span class="sxs-lookup"><span data-stu-id="8a361-146">Description</span></span> |
| --- | --- |
| <span data-ttu-id="8a361-147">refresh （强制？：布尔值）</span><span class="sxs-lookup"><span data-stu-id="8a361-147">refresh(force?:boolean)</span></span> | <span data-ttu-id="8a361-148">调用方法以刷新数据。</span><span class="sxs-lookup"><span data-stu-id="8a361-148">Call the method to refresh the data.</span></span> <span data-ttu-id="8a361-149">默认情况下，UI 仅在数据发生更改时才会更新。</span><span class="sxs-lookup"><span data-stu-id="8a361-149">By default, the UI will only update if the data changes.</span></span> <span data-ttu-id="8a361-150">通过`true`传递以强制更新组件。</span><span class="sxs-lookup"><span data-stu-id="8a361-150">Pass `true` to force the component to update.</span></span>  |


## <a name="events"></a><span data-ttu-id="8a361-151">事件</span><span class="sxs-lookup"><span data-stu-id="8a361-151">Events</span></span>
| <span data-ttu-id="8a361-152">事件</span><span class="sxs-lookup"><span data-stu-id="8a361-152">Event</span></span> | <span data-ttu-id="8a361-153">详细信息</span><span class="sxs-lookup"><span data-stu-id="8a361-153">Detail</span></span> | <span data-ttu-id="8a361-154">说明</span><span class="sxs-lookup"><span data-stu-id="8a361-154">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8a361-155">dataChange</span><span class="sxs-lookup"><span data-stu-id="8a361-155">dataChange</span></span> | <span data-ttu-id="8a361-156">详细信息包含`response`和`error`对象。</span><span class="sxs-lookup"><span data-stu-id="8a361-156">The detail contains the `response` and `error` objects.</span></span> | <span data-ttu-id="8a361-157">在响应或错误发生更改时激发。</span><span class="sxs-lookup"><span data-stu-id="8a361-157">Fired when the response or error change.</span></span> |

## <a name="templates"></a><span data-ttu-id="8a361-158">模板</span><span class="sxs-lookup"><span data-stu-id="8a361-158">Templates</span></span>

<span data-ttu-id="8a361-159">`mgt-get`组件支持几个可用于定义外观的[模板](../templates.md)。</span><span class="sxs-lookup"><span data-stu-id="8a361-159">The `mgt-get` component supports several [templates](../templates.md) that you can use to define the look and feel.</span></span> <span data-ttu-id="8a361-160">若要指定模板，请在`<template>`组件内添加一个元素，并`data-type`将值设置为下列值之一。</span><span class="sxs-lookup"><span data-stu-id="8a361-160">To specify a template, include a `<template>` element inside a component and set the `data-type` value to one of the following.</span></span>

| <span data-ttu-id="8a361-161">数据类型</span><span class="sxs-lookup"><span data-stu-id="8a361-161">Data type</span></span> | <span data-ttu-id="8a361-162">数据上下文</span><span class="sxs-lookup"><span data-stu-id="8a361-162">Data context</span></span> | <span data-ttu-id="8a361-163">说明</span><span class="sxs-lookup"><span data-stu-id="8a361-163">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8a361-164">设置</span><span class="sxs-lookup"><span data-stu-id="8a361-164">default</span></span> | <span data-ttu-id="8a361-165">来自 Microsoft Graph 的响应。</span><span class="sxs-lookup"><span data-stu-id="8a361-165">The response from Microsoft Graph.</span></span> | <span data-ttu-id="8a361-166">若要呈现来自 Microsoft Graph 的数据，则需要默认模板。</span><span class="sxs-lookup"><span data-stu-id="8a361-166">The default template is required to render the data coming from Microsoft Graph.</span></span> |
| <span data-ttu-id="8a361-167">值</span><span class="sxs-lookup"><span data-stu-id="8a361-167">value</span></span> | <span data-ttu-id="8a361-168">返回`value`的数组中的数据项</span><span class="sxs-lookup"><span data-stu-id="8a361-168">Data item from the returned `value` array</span></span> | <span data-ttu-id="8a361-169">在预期`value`来自图表的响应`default`以包含一组项目（如**邮件**、**文件**或**用户**）时，使用模板而不是模板。</span><span class="sxs-lookup"><span data-stu-id="8a361-169">Use the `value` template instead of the `default` template when expecting the response from the graph to contain an array of items - such as **messages**, **files**, or **users**.</span></span> <span data-ttu-id="8a361-170">该`value`模板将自动为资源返回的每个项目重复。</span><span class="sxs-lookup"><span data-stu-id="8a361-170">The `value` template will automatically be repeated for each item returned by the resource.</span></span> <span data-ttu-id="8a361-171">`value`模板还将在项目准备就绪后立即开始呈现项目（与默认模板不同）。</span><span class="sxs-lookup"><span data-stu-id="8a361-171">The `value` template will also start rendering the items as soon as they are ready (unlike the default template).</span></span>|
| <span data-ttu-id="8a361-172">error</span><span class="sxs-lookup"><span data-stu-id="8a361-172">error</span></span> | <span data-ttu-id="8a361-173">Microsoft Graph 中的错误。</span><span class="sxs-lookup"><span data-stu-id="8a361-173">The error from Microsoft Graph.</span></span> | <span data-ttu-id="8a361-174">如果发出请求时出错，将使用此模板。</span><span class="sxs-lookup"><span data-stu-id="8a361-174">This template will be used if there is an error making the request.</span></span> |
| <span data-ttu-id="8a361-175">装载</span><span class="sxs-lookup"><span data-stu-id="8a361-175">loading</span></span> | <span data-ttu-id="8a361-176">不适用</span><span class="sxs-lookup"><span data-stu-id="8a361-176">N/A</span></span> | <span data-ttu-id="8a361-177">在发出请求时使用此模板。</span><span class="sxs-lookup"><span data-stu-id="8a361-177">This template is used while the request is being made.</span></span> |

## <a name="microsoft-graph-permissions"></a><span data-ttu-id="8a361-178">Microsoft Graph 权限</span><span class="sxs-lookup"><span data-stu-id="8a361-178">Microsoft Graph permissions</span></span>

<span data-ttu-id="8a361-179">有关权限的详细信息，请参阅 Microsoft Graph[权限参考](https://docs.microsoft.com/graph/permissions-reference)。</span><span class="sxs-lookup"><span data-stu-id="8a361-179">For more information about permissions, see the Microsoft Graph [permissions reference](https://docs.microsoft.com/graph/permissions-reference).</span></span> 

## <a name="authentication"></a><span data-ttu-id="8a361-180">身份验证</span><span class="sxs-lookup"><span data-stu-id="8a361-180">Authentication</span></span>

<span data-ttu-id="8a361-181">该控件使用[身份验证文档](./../providers.md)中介绍的全局身份验证提供程序提取所需的数据。</span><span class="sxs-lookup"><span data-stu-id="8a361-181">The control uses the global authentication provider described in the [authentication documentation](./../providers.md) to fetch the required data.</span></span>
